<html lang="{{ site.lang | default: "en-US" }}"`>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">

        <link rel="stylesheet" href="metaug_js/tf.css">
        <script src="assets/js/scale.fix.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <link rel="stylesheet" type="text/css" href="google_chart.css">

		<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.0.0/dist/tf.min.js"></script>
		<script src="metaug_js/math.js"></script>

        <!--[if lt IE 9]>
        <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
    </head>

<script>

</script>

<body>
	<div class="contentwrapper">
	<section>
	<h1 style="text-align:center; max-width: 500px; margin: auto;">Universal linguistic inductive biases via meta-learning</h1>
	<br>
	<p style="text-align:center;"><a href="http://rtmccoy.com/">Tom McCoy</a>, <a href="https://eringrant.github.io/">Erin Grant</a>, <a href="https://www.microsoft.com/en-us/research/people/psmo/">Paul Smolensky</a>, <a href="http://cocosci.princeton.edu/tom/index.php">Tom Griffiths</a>, <a href="https://tallinzen.net/">Tal Linzen</a></p>


	<p><em>This post accompanies the paper found <a href="https://arxiv.org/pdf/2006.16324.pdf">here</a> and the code found <a href="https://github.com/tommccoy1/meta-learning-linguistic-biases">here</a>.</em></p>

	<h2>Introduction</h2>

	<p>Language acquisition involves a complex interplay between the data and the learner. The importance of data is clear: we can only learn a language if we have experience with it. Less obviously, acquisition is also guided by properties of the learner called <b style="font-weight:bold">inductive biases</b>, which determine how the learner will generalize beyond the utterances they have encountered. As an example, consider the following pattern:</p>

	<ul>
		<li style="color: blue">gbg &rarr; .ga.ba.ga.</li>
		<li style="color: blue">zz &rarr; .za.za.</li>
		<li style="color: blue">trv &rarr; <span style="color: purple">???</span></li>
	</ul>


	<p>What output should replace the question marks? You probably answered <span style="color:blue"><em>.ta.ra.va.</em></span> even though other answers are conceivable; e.g., the provided outputs are consistent with a rule that involves reversing the input, so the answer could instead be <span style="color:blue"><em>.va.ra.ta.</em></span> If you answered <span style="color:blue"><em>.ta.ra.va.</em></span> instead of <span style="color:blue"><em>.va.ra.ta.</em></span>, it suggests that you have an inductive bias for preserving the input order.</p>

	<p>Which inductive biases enable humans to acquire language? The answer is hotly debated. To facilitate computational modeling aimed at answering this question, we introduce a framework for giving particular linguistic inductive biases to a model. Such a model can then be used to explore the effects of those inductive biases, and to see which biases yield the most human-like generalization behavior.</p>

	<p>In our framework, the inductive biases are encoded in the initial state of a neural network. This initial state is found with <b style="font-weight:bold">meta-learning</b>, a technique through which a model discovers how to acquire new languages more easily via exposure to many possible languages. By controlling the properties of the languages that are used during meta-learning, we can control the set of inductive biases that meta-learning imparts.</p>


	<h2>Try it out!</h2>

	<p>To demonstrate this framework, we use the linguistic domain of syllable structure.  For a given language, the model must learn how to map a sequence of sounds (e.g., <em>tarava</em>)  into a sequence of syllables (e.g., <em>.ta.ra.va.</em>). Each language has restrictions on what types of syllables are allowed, and sounds may need to be inserted or deleted to meet these restrictions. For example, if a language requires all syllables to end with a vowel, the input <em>kep</em> might map to <em>.ke.pa.</em>  (if the language uses insertion) or <em>.ke.</em>  (if the language uses deletion).</p>


	<p>The demo below shows how a neural network initialized with meta-learning can learn syllable structure mappings much more quickly than a neural network with a standard random initialization. This demo trains the models in your browser using randomly-generated data, so none of the results that you see are cherry-picked.</p>

<div style="margin: auto; max-width: 850px;" class="demowrapper">

<div style="overflow: hidden;">

	<div id="patterndiv" style="padding: 10px; overflow:hidden; float: left;border-bottom:1pt solid black;">
		<span style="max-width: 410px;text-align: justify; margin-right: 10px; display: inline-block; font-size: 13px;"><b style="font-weight:bold">Pattern to be learned:</b> 
			<span id="langdesc" style="text-align: justify">Delete sounds as necessary to ensure that the output is pronounceable, but otherwise change nothing; add periods to mark syllable boundariesDelete sounds as necessary to ensure that the output is pronounceable, but otherwise change nothing; add periods to mark syllable boundaries.</span>
		</span> 
		<button type="button" class="genbtn" onclick="random_language(true, trf);" style="display: inline-block; vertical-align:top;">Random new language</button>
		<button type="button" class="genbtn" onclick="toggleshowadv()" style="display: inline-block; vertical-align:top;"><span id="advbtntxt">Show advanced settings</span></button> 
	</div>
	<div id="advancedsettings" style="border-bottom: 1px solid black">


	<div id="parameters" class="params" style="max-width:320; display:inline-block; vertical-align:top; padding:10px;">

	<p>
		<b style="font-weight:bold">Define a language based on the factors in Fig. 3 of the paper (middle panel):</b> Choose properties for the language from the fields below.
	</p>

	<div>Constraint ranking:</div>


	<div class="dropdown">
  		<button onclick="dropFunction()" class="dropbtn" id="rankbtn" style='font-variant:small-caps; font-size:15px;'>Dropdown</button>
  		<div id="myDropdown" class="dropdown-content">
    		<a onclick="ranktoggle('(0, 1, 2, 3)')"><span style='font-variant:small-caps;'>Onset, NoCoda, NoDeletion &#187; NoInsertion</span></a>
  			<a onclick="ranktoggle('(0, 1, 3, 2)')"><span style='font-variant:small-caps;'>Onset, NoCoda, NoInsertion &#187; NoDeletion</span></a>
			<a onclick="ranktoggle('(0, 3, 2, 1)')"><span style='font-variant:small-caps;'>Onset, NoInsertion &#187; NoDeletion &#187; NoCoda</span></a>
			<a onclick="ranktoggle('(1, 3, 2, 0)')"><span style='font-variant:small-caps;'>NoCoda, NoInsertion &#187;  NoDeletion &#187; Onset</span></a>
			<a onclick="ranktoggle('(0, 2, 3, 1)')"><span style='font-variant:small-caps;'>Onset, NoDeletion &#187; NoInsertion &#187; NoCoda</span></a>
			<a onclick="ranktoggle('(1, 2, 3, 0)')"><span style='font-variant:small-caps;'>NoCoda, NoDeletion &#187; NoInsertion &#187; Onset</span></a>
			<a onclick="ranktoggle('(3, 2, 0, 1)')"><span style='font-variant:small-caps;'>NoInsertion &#187; NoDeletion &#187; Onset, NoCoda</span></a>
			<a onclick="ranktoggle('(2, 3, 0, 1)')"><span style='font-variant:small-caps;'>NoDeletion &#187; NoInsertion &#187; Onset, NoCoda</span></a>
		</div>
	</div>
	<br><br>
		
	<div>Set of consonants:</div>
	<div> <button id="btnb" class="vinvbtn" type="button" onclick="ctoggle('b')">b</button><button id="btnc" class="vinvbtn" type="button" onclick="ctoggle('c')">c</button><button id="btnd" class="vinvbtn" type="button" onclick="ctoggle('d')">d</button><button id="btnf" class="vinvbtn" type="button" onclick="ctoggle('f')">f</button><button id="btng" class="vinvbtn" type="button" onclick="ctoggle('g')">g</button><button id="btnh" class="vinvbtn" type="button" onclick="ctoggle('h')">h</button><button id="btnj" class="vinvbtn" type="button" onclick="ctoggle('j')">j</button><button id="btnk" class="vinvbtn" type="button" onclick="ctoggle('k')">k</button><button id="btnm" class="vinvbtn" type="button" onclick="ctoggle('m')">m</button></div>
	<div><button id="btnn" class="vinvbtn" type="button" onclick="ctoggle('n')">n</button><button id="btnp" class="vinvbtn" type="button" onclick="ctoggle('p')">p</button><button id="btnq" class="vinvbtn" type="button" onclick="ctoggle('q')">q</button><button id="btnr" class="vinvbtn" type="button" onclick="ctoggle('r')">r</button><button id="btns" class="vinvbtn" type="button" onclick="ctoggle('s')">s</button><button id="btnt" class="vinvbtn" type="button" onclick="ctoggle('t')">t</button><button id="btnv" class="vinvbtn" type="button" onclick="ctoggle('v')">v</button><button id="btnw" class="vinvbtn" type="button" onclick="ctoggle('w')">w</button><button id="btnx" class="vinvbtn" type="button" onclick="ctoggle('x')">x</button><button id="btnz" class="vinvbtn" type="button" onclick="ctoggle('z')">z</button></div>
		
	<br>
	<div>Set of vowels:</div>

	<div> <button id="btna" class="vinvbtn" type="button" onclick="vtoggle('a')">a</button><button id="btne" class="vinvbtn" type="button" onclick="vtoggle('e')">e</button><button id="btni" class="vinvbtn" type="button" onclick="vtoggle('i')">i</button><button id="btno" class="vinvbtn" type="button" onclick="vtoggle('o')">o</button><button id="btnu" class="vinvbtn" type="button" onclick="vtoggle('u')">u</button><button id="btnbiga" class="vinvbtn" type="button" onclick="vtoggle('A')">A</button><button id="btnbige" class="vinvbtn" type="button" onclick="vtoggle('E')">E</button><button id="btnbigo" class="vinvbtn" type="button" onclick="vtoggle('O')">O</button><button id="btnbigu" class="vinvbtn" type="button" onclick="vtoggle('U')">U</button></div>
	<br>
	
	<div>Consonant for insertion: <button id="btnepb" class="vinvbtn" type="button" onclick="ceptoggle('b')">b</button><button id="btnepc" class="vinvbtn" type="button" onclick="ceptoggle('c')">c</button><button id="btnepd" class="vinvbtn" type="button" onclick="ceptoggle('d')">d</button><button id="btnepf" class="vinvbtn" type="button" onclick="ceptoggle('f')">f</button><button id="btnepg" class="vinvbtn" type="button" onclick="ceptoggle('g')">g</button><button id="btneph" class="vinvbtn" type="button" onclick="ceptoggle('h')">h</button><button id="btnepj" class="vinvbtn" type="button" onclick="ceptoggle('j')">j</button><button id="btnepk" class="vinvbtn" type="button" onclick="ceptoggle('k')">k</button><button id="btnepm" class="vinvbtn" type="button" onclick="ceptoggle('m')">m</button><button id="btnepn" class="vinvbtn" type="button" onclick="ceptoggle('n')">n</button><button id="btnepp" class="vinvbtn" type="button" onclick="ceptoggle('p')">p</button><button id="btnepq" class="vinvbtn" type="button" onclick="ceptoggle('q')">q</button><button id="btnepr" class="vinvbtn" type="button" onclick="ceptoggle('r')">r</button><button id="btneps" class="vinvbtn" type="button" onclick="ceptoggle('s')">s</button><button id="btnept" class="vinvbtn" type="button" onclick="ceptoggle('t')">t</button><button id="btnepv" class="vinvbtn" type="button" onclick="ceptoggle('v')">v</button><button id="btnepw" class="vinvbtn" type="button" onclick="ceptoggle('w')">w</button><button id="btnepx" class="vinvbtn" type="button" onclick="ceptoggle('x')">x</button><button id="btnepz" class="vinvbtn" type="button" onclick="ceptoggle('z')">z</button></div>
		<div>Vowel for insertion: <button id="btnepa" class="vinvbtn" type="button" onclick="veptoggle('a')">a</button><button id="btnepe" class="vinvbtn" type="button" onclick="veptoggle('e')">e</button><button id="btnepi" class="vinvbtn" type="button" onclick="veptoggle('i')">i</button><button id="btnepo" class="vinvbtn" type="button" onclick="veptoggle('o')">o</button><button id="btnepu" class="vinvbtn" type="button" onclick="veptoggle('u')">u</button><button id="btnepbiga" class="vinvbtn" type="button" onclick="veptoggle('A')">A</button><button id="btnepbige" class="vinvbtn" type="button" onclick="veptoggle('E')">E</button><button id="btnepbigo" class="vinvbtn" type="button" onclick="veptoggle('O')">O</button><button id="btnepbigu" class="vinvbtn" type="button" onclick="veptoggle('U')">U</button></div>

		<br>
		<div>
			<button type="button" onclick="renew_language()">Generate language with these parameters</button>
		</div>

	</div> <!-- End of parameters -->

	<div id="manualinputs" class="manual" style="max-width:320; display:inline-block; vertical-align:top; padding-left:20px; padding-top:10px;">
		<p><b style="font-weight:bold">Manually define a training and test set:</b> Enter your training and test examples in the spaces below. Use one line per input-output pair, with a comma (no spaces) separating the input and output.</p>

		<div>Training set</div>
		<textarea id="traintextarea" cols="30" rows="5" maxlength="5000"></textarea>

		<br><br>
		<div>Test set</div>
		<textarea id="testtextarea" cols="30" rows="5" maxlength="120"></textarea>
		
		<br>
		<button onclick="random_language(false, trf)">Use the above training and test sets</button>
		<div id="errorarea"></div>
	</div>

	<div style="border-top: 1px solid black; padding:10px;">
		<div style="display: inline-block; vertical-align: top; max-width: 410px;">
			<b style="font-weight:bold">Investigate absolute universals:</b> Certain inputs will map to the same output regardless of language. Thus, our models will ideally be able to handle these inputs even without any training. Click these buttons to test the models on such inputs. <em>C</em> stands for <em>consonant</em>, and <em>V</em> stands for <em>vowel</em>; any <em>CV</em> input should map to <em>.CV.</em>, while any <em>CVCV</em> input should map to <em>.CV.CV.</em>
		</div>

		<button type="button" class="genbtn" onclick="random_language(true, is_cv);" style="display: inline-block; vertical-align:top;">All CV inputs</button>

		<button type="button" class="genbtn" onclick="random_language(true, is_cvcv);" style="display: inline-block; vertical-align:top;">All CVCV inputs</button>


	</div>

	</div> <!-- End of advanced settings -->


	<div style="float: left; padding: 10px;">
		<div "text-align: center; padding: 10px;">
			<div style="width: 100%; margin: 0 auto; padding: 10px;">
				<b style="font-weight:bold">Training examples:</b> <span id="traincount">0</span>
			</div> 
		</div>
		<div id="trainingexamplelist" style="border: solid; height:150px; width: 200px; overflow: scroll; padding: 10px;"></div>
		<br>
		<div style="text-align: center;">
			<button type="button" class="trainbtn" onclick="update_display(seq2seq, 'meta');update_display(seq2seqb, 'random');fitfitfit(seq2seq, 'meta');fitfitfit(seq2seqb, 'random', add_train=true)" style="font-size: 16px; display: inline-block;" id="oneexamplebtn">Train on one example</button>
		</div>
	</div>


	<div style="float: left; padding: 10px;">

		<div style="text-align: center; padding: 10px;"><b style="font-weight:bold">Test set predictions after training on <span id="traincount2">0</span> <span id="exsing">examples</span></b></div>
		<div>
			<table class="hor-minimalist-a">
				<tr class="top">
					<th style="width:50;" class='cell'><div>Input</div></th>
					<th style="width:100;" class='cell'><div>Correct output</div></th>
					<th style="width:110;" class='cell'><div>Meta-initialized<br>model's output</div></th>
					<th style="width:150;" class='cellcollapsible'><div class='cell'>Randomly-initialized<br>model's output</div></th>
				</tr>
				<tr>
					<td class='cell'><div id="inb1">rOau</div></td>
					<td class='cell'><div id="corrb1">.rO.a.u.</div></td>
					<td class='cell'><div id="metaoutb1">.rO.a.u.</div></td>
					<td class='cellcollapsible'><div id="randomoutb1">.rO.a.u.</div></td>
				</tr>
				<tr>
					<td class='cell'><div id="inb2">axxaO</div></td>
					<td class='cell'><div id="corrb2">.a.xa.O.</div></td>
					<td class='cell'><div id="metaoutb2">.a.xa.O.</div></td>
					<td class='cellcollapsible'><div id="randomoutb2">.a.xa.O.</div></td>
				</tr>
				<tr>
					<td class='cell'><div id="inb3">rxxa</div></td>
					<td class='cell'><div id="corrb3">.xa.</div></td>
					<td class='cell'><div id="metaoutb3">.xa.</div></td>
					<td class='cellcollapsible'><div id="randomoutb3">.xa.</div></td>
				</tr>
				<tr>
					<td class='cell'><div id="inb4">axrxu</div></td>
					<td class='cell'><div id="corrb4">.a.xu.</div></td>
					<td class='cell'><div id="metaoutb4">.a.xu.</div></td>
					<td class='cellcollapsible'><div id="randomoutb4">.a.xu.</div></td>
				</tr>
				<tr>
					<td class='cell'><div id="inb5">ttxaO</div></td>
					<td class='cell'><div id="corrb5">.xa.O.</div></td>
					<td class='cell'><div id="metaoutb5">.xa.O.</div></td>
					<td class='cellcollapsible'><div id="randomoutb5">.xa.O.</div></td>
				</tr>
				<tr>
					<td class='cell'><div id="inb6">rOau</div></td>
					<td class='cell'><div id="corrb6">.rO.a.u.</div></td>
					<td class='cell'><div id="metaoutb6">.rO.a.u.</div></td>
					<td class='cellcollapsible'><div id="randomoutb6">.rO.a.u.</div></td>
				</tr>
			</table>
		</div>

	</div>

	</div>
</div>

<div style="padding-top: 15px; padding-bottom: 40px; padding-left: 50px; padding-right: 50px; font-size: 13px;">
	<em>How to use: Click "Train on one example" to show the models a single input-output pair (the training is done in your browser, so none of the results that you see have been pre-computed). Click "Random new language" to restart the demo with a new language.</em>
</div>


<p>The meta-initialized model can typically learn any of these syllable structure mappings from fewer than 100 examples&mdash;sometimes substantially fewer. In contrast, after the same number of examples, the outputs of the randomly initialized model are usually nowhere near the correct answers.</p>


<p>In the class of languages that we include in our experiment, certain inputs will map to the same output across all languages; such mappings are therefore <em>absolute universals</em>, or properties that all languages possess. For example, an input of the form <em>CVCV</em> will always map to <em>.CV.CV.</em> (where <em>C</em> stands for any consonant, <em>V</em> stands for any vowel, and periods indicate word and syllable boundaries). Even though some languages allow syllables of the form <em>.CVC.</em> and <em>.V.</em>, the input <em>CVCV</em> will only ever map to <em>.CV.CV.</em>, never to <em>.CVC.V.</em> The meta-initialized model typically gets the correct output for such inputs without any training in the language, indicating that the meta-learning process has imparted these absolute universals. You can test these absolute universals by clicking "Show advanced settings" in the demo.</p>  



<p>How many examples does the randomly-initialized model need before it begins performing well? The table below should give some sense of this; it contains data from one language for each of the 8 abstract categories of languages that we use in our experiments. On these languages, the randomly-initialized model typically needs a few thousand examples, compared to a few dozen for the meta-initialized model.</p>

<div style="margin:auto">
<div style="max-width:600px; margin:auto;">
	<div>Click to select language type:</div>
	<div>(defined by a constraint ranking)</div>
	<div class="dropdown">
  		<button onclick="dropFunction2()" class="dropbtn" id="rankbtn2" style="padding:16px;">Choose constraint ranking</button>
  		<div id="myDropdown2" class="dropdown-content">
    		<a onclick="change_thousands(4, '(0, 1, 2, 3)')"><span style='font-variant:small-caps;'>Onset, NoCoda, NoDeletion &#187; NoInsertion</span></a>
  			<a onclick="change_thousands(7, '(0, 1, 3, 2)')"><span style='font-variant:small-caps;'>Onset, NoCoda, NoInsertion &#187; NoDeletion</span></a>
			<a onclick="change_thousands(8, '(0, 3, 2, 1)')"><span style='font-variant:small-caps;'>Onset, NoInsertion &#187; NoDeletion &#187; NoCoda</span></a>
			<a onclick="change_thousands(1, '(1, 3, 2, 0)')"><span style='font-variant:small-caps;'>NoCoda, NoInsertion &#187;  NoDeletion &#187; Onset</span></a>
			<a onclick="change_thousands(3, '(0, 2, 3, 1)')"><span style='font-variant:small-caps;'>Onset, NoDeletion &#187; NoInsertion &#187; NoCoda</span></a>
			<a onclick="change_thousands(6, '(1, 2, 3, 0)')"><span style='font-variant:small-caps;'>NoCoda, NoDeletion &#187; NoInsertion &#187; Onset</span></a>
			<a onclick="change_thousands(5, '(3, 2, 0, 1)')"><span style='font-variant:small-caps;'>NoInsertion &#187; NoDeletion &#187; Onset, NoCoda</span></a>
			<a onclick="change_thousands(2, '(2, 3, 0, 1)')"><span style='font-variant:small-caps;'>NoDeletion &#187; NoInsertion &#187; Onset, NoCoda</span></a>
		</div>
	</div>

</div>
</div>
<br>
<div class="outertable" id="thousands1">
<table class="thousands">
	<tr>
		<th>input</th>
		<th>correct output</th>
		<th>0 iterations</th>
		<th>1,000 iterations</th>
		<th>2,000 iterations</th>
		<th>3,000 iterations</th>
		<th>4,000 iterations</th>
		<th>5,000 iterations</th>
		<th>6,000 iterations</th>
		<th>7,000 iterations</th>
		<th>8,000 iterations</th>
		<th>9,000 iterations</th>
		<th>10,000 iterations</th>
	</tr>
	<tr>
		<td>uttxr</td>
		<td>.u.</td>
		<td><span style='color: red'>pzrrrrrrrr</span></td>
		<td><span style='color: red'>.u.xu.</span></td>
		<td><span style='color: green'>.u.</span></td>
		<td><span style='color: green'>.u.</span></td>
		<td><span style='color: green'>.u.</span></td>
		<td><span style='color: green'>.u.</span></td>
		<td><span style='color: green'>.u.</span></td>
		<td><span style='color: green'>.u.</span></td>
		<td><span style='color: green'>.u.</span></td>
		<td><span style='color: green'>.u.</span></td>
		<td><span style='color: green'>.u.</span></td>
	</tr>
	<tr>
		<td>raxur</td>
		<td>.ra.xu.</td>
		<td><span style='color: red'>pzrrrrrrrr</span></td>
		<td><span style='color: green'>.ra.xu.</span></td>
		<td><span style='color: green'>.ra.xu.</span></td>
		<td><span style='color: green'>.ra.xu.</span></td>
		<td><span style='color: red'>.ra.xu.u.</span></td>
		<td><span style='color: red'>.ra.</span></td>
		<td><span style='color: green'>.ra.xu.</span></td>
		<td><span style='color: green'>.ra.xu.</span></td>
		<td><span style='color: green'>.ra.xu.</span></td>
		<td><span style='color: green'>.ra.xu.</span></td>
		<td><span style='color: green'>.ra.xu.</span></td>
	</tr>
	<tr>
		<td>Oar</td>
		<td>.O.a.</td>
		<td><span style='color: red'>pzrrrrrrrr</td></span>
		<td><span style='color: red'>.O.ra.</span></td>
		<td><span style='color: green'>.O.a.</span></td>
		<td><span style='color: green'>.O.a.</span></td>
		<td><span style='color: green'>.O.a.</span></td>
		<td><span style='color: green'>.O.a.</span></td>
		<td><span style='color: green'>.O.a.</span></td>
		<td><span style='color: green'>.O.a.</span></td>
		<td><span style='color: green'>.O.a.</span></td>
		<td><span style='color: green'>.O.a.</span></td>
		<td><span style='color: green'>.O.a.</span></td>
	</tr>
	<tr>
		<td>atrau</td>
		<td>.a.ra.u.</td>
		<td><span style='color: red'>pzrrrrrrrr</span></td>
		<td><span style='color: red'>.a.ra.</span></td>
		<td><span style='color: green'>.a.ra.u.</span></td>
		<td><span style='color: green'>.a.ru.u.</span></td>
		<td><span style='color: green'>.a.ra.u.</span></td>
		<td><span style='color: red'>.a.ra.</span></td>
		<td><span style='color: green'>.a.ra.u.</span></td>
		<td><span style='color: green'>.a.ra.u.</span></td>
		<td><span style='color: green'>.a.ra.u.</span></td>
		<td><span style='color: green'>.a.ra.u.</span></td>
		<td><span style='color: green'>.a.ra.u.</span></td>
	</tr>
	<tr>
		<td>tOuxa</td>
		<td>.tO.u.xa.</td>
		<td><span style='color: red'>pzrrrrrrrr</span></td>
		<td><span style='color: red'>.tO.xo.x.</span></td>
		<td><span style='color: green'>.tO.u.xa.</span></td>
		<td><span style='color: green'>.tO.u.xa.</span></td>
		<td><span style='color: green'>.tO.u.xa.</span></td>
		<td><span style='color: green'>.tO.u.xa.</span></td>
		<td><span style='color: green'>.tO.u.xa.</span></td> 
		<td><span style='color: green'>.tO.u.xa.</span></td>
		<td><span style='color: green'>.tO.u.xa.</span></td>
		<td><span style='color: green'>.tO.u.xa.</span></td>
		<td><span style='color: green'>.tO.u.xa.</span></td>
	</tr>
	<tr>
		<td>xruto</td>
		<td>.ru.tO.</td>
		<td><span style='color: red'>prrrrrrrrr</span></td>
		<td><span style='color: red'>.tu.xO.</span></td>
		<td><span style='color: red'>.tu.</span></td>
		<td><span style='color: green'>.ru.tO.</span></td>
		<td><span style='color: red'>.ru.tO.O.</span></td>
		<td><span style='color: green'>.ru.tO.</span></td>
		<td><span style='color: green'>.ru.tO.</span></td>
		<td><span style='color: green'>.ru.tO.</span></td>
		<td><span style='color: green'>.ru.tO.</span></td>
		<td><span style='color: green'>.ru.tO.</span></td>
		<td><span style='color: green'>.ru.tO.</span></td>
	</tr>
	<tr>
		<td>xOxra</td>
		<td>.xO.ra.</td>
		<td><span style='color: red'>pzrrrrrrrr</span></td>
		<td><span style='color: red'>.xO.xa.</span></td>
		<td><span style='color: red'>.xO.xa.</span></td>
		<td><span style='color: green'>.xO.ra.</span></td>
		<td><span style='color: green'>.xO.ra.</span></td>
		<td><span style='color: green'>.xO.ra.</span></td>
		<td><span style='color: green'>.xO.ra.</span></td>
		<td><span style='color: green'>.xO.ra.</span></td>
		<td><span style='color: green'>.xO.ra.</span></td>
		<td><span style='color: green'>.xO.ra.</span></td>
		<td><span style='color: green'>.xO.ra.</span></td>
	</tr>
	<tr>
		<td>uuuuO</td>
		<td>.u.u.u.u.O.</td>
		<td><span style='color: red'>xhUjjjjjjj</span></td>
		<td><span style='color: red'>.u.uu.O..</span></td>
		<td><span style='color: red'>.u.u.u.u.</span></td>
		<td><span style='color: green'>.u.u.u.u.O.</span></td>
		<td><span style='color: red'>.u.u.u.O.O.</span></td>
		<td><span style='color: red'>.u.u.u.O.</span></td>
		<td><span style='color: red'>.u.u.u.u.</span></td>
		<td><span style='color: green'>.u.u.u.u.O.</span></td>
		<td><span style='color: green'>.u.u.u.u.O.</span></td>
		<td><span style='color: red'>.u.u.u.u.u.</span></td>
		<td><span style='color: green'>.u.u.u.u.O.</span></td>
	</tr>
	<tr>
		<td>xt</td>
		<td>&lt;empty&gt;</td>
		<td><span style='color: red'>prrrrrrrrr</td></span>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
	</tr>
	<tr>
		<td>aata</td>
		<td>.a.a.ta.</td>
		<td><span style='color: red'>pai.iii.ii</span></td>
		<td><span style='color: red'>.a.ta.</span></td>
		<td><span style='color: green'>.a.a.ta.</span></td>
		<td><span style='color: green'>.a.a.ta.</span></td>
		<td><span style='color: green'>.a.a.ta.</span></td>
		<td><span style='color: green'>.a.a.ta.</span></td>
		<td><span style='color: green'>.a.a.ta.</span></td>
		<td><span style='color: green'>.a.a.ta.</span></td>
		<td><span style='color: green'>.a.a.ta.</span></td>
		<td><span style='color: green'>.a.a.ta.</span></td>
		<td><span style='color: green'>.a.a.ta.</span></td>
	</tr>
</table></div>

<div class="outertable" id="thousands2">
<table  class="thousands">
	<tr>
		<th>input</th>
		<th>correct output</th>
		<th>0 iterations</th>
		<th>1,000 iterations</th>
		<th>2,000 iterations</th>
		<th>3,000 iterations</th>
		<th>4,000 iterations</th>
		<th>5,000 iterations</th>
		<th>6,000 iterations</th>
		<th>7,000 iterations</th>
		<th>8,000 iterations</th>
		<th>9,000 iterations</th>
		<th>10000 iterations</th>
	</tr>
	<tr>
		<td>UUEm</td>
		<td>.U.U.Em.</td>
		<td><span style='color: red'>emmm....Ok</td></span>
		<td><span style='color: red'>.U.mU.E..</span></td>
		<td><span style='color: red'>.U.E.m</span></td>
		<td><span style='color: green'>.U.U.Em.</span></td>
		<td><span style='color: green'>.U.U.Em.</span></td>
		<td><span style='color: green'>.U.U.Em.</span></td>
		<td><span style='color: green'>.U.U.Em.</span></td>
		<td><span style='color: red'>.U.U.E.Em.</span></td>
		<td><span style='color: green'>.U.U.Em.</span></td>
		<td><span style='color: green'>.U.U.Em.</span></td>
		<td><span style='color: green'>.U.U.Em.</span></td>
	</tr>
	<tr>
		<td>pppE</td>
		<td>.pEp.pE.</td>
		<td><span style='color: red'>emmm....Ok</span></td>
		<td><span style='color: red'>.pE.pE.EE..</span></td>
		<td><span style='color: green'>.pEp.pE..</span></td>
		<td><span style='color: green'>.pEp.pE.</span></td>
		<td><span style='color: red'>.pE..pE.</span></td>
		<td><span style='color: green'>.pEp.pE.</span></td>
		<td><span style='color: green'>.pEp.pE.</span></td>
		<td><span style='color: green'>.pEp.pE.</span></td>
		<td><span style='color: green'>.pEp.pE.</span></td>
		<td><span style='color: green'>.pEp.pE.</span></td>
		<td><span style='color: green'>.pEp.pE.</span></td>
	</tr>
	<tr>
		<td>UmE</td>
		<td>.U.mE.</td>
		<td><span style='color: red'>emmm....Ok</span></td>
		<td><span style='color: red'>.U.mE..</span></td>
		<td><span style='color: green'>.U.mE.</span></td>
		<td><span style='color: green'>.U.mE.</span></td>
		<td><span style='color: green'>.U.mE.</span></td>
		<td><span style='color: green'>.U.mE.</span></td>
		<td><span style='color: green'>.U.mE.</span></td>
		<td><span style='color: green'>.U.mE.</span></td>
		<td><span style='color: green'>.U.mE.</span></td>
		<td><span style='color: green'>.U.mE.</span></td>
		<td><span style='color: green'>.U.mE.</span></td>
	</tr>
	<tr>
		<td>&lt;empty&gt;</td>
		<td>&lt;empty&gt;</td>
		<td><span style='color: red'>emmm....Ok</span></td>
		<td><span style='color: red'>.EE.</span></td>
		<td><span style='color: red'>.EE.</span></td>
		<td><span style='color: red'>.EE.</span></td>
		<td><span style='color: red'>.EE.</span></td>
		<td><span style='color: red'>.xE.</span></td>
		<td><span style='color: red'>.cE.</span></td>
		<td><span style='color: red'>.xE.</span></td>
		<td><span style='color: red'>.xE.</span></td>
		<td><span style='color: red'>.xE.</span></td>
		<td><span style='color: red'>.cE.</span></td>
	</tr>
	<tr>
		<td>xEpcU</td>
		<td>.xEp.cU.</td>
		<td><span style='color: red'>eNmmm....O</span></td>
		<td><span style='color: red'>.xE.......</span></td>
		<td><span style='color: red'>.xE..pE..U.</span></td>
		<td><span style='color: red'>.xE..pU.</span></td>
		<td><span style='color: red'>.xE..cc.UU.</span></td>
		<td><span style='color: green'>.xEp.cU.</span></td>
		<td><span style='color: green'>.xEp.cU.</span></td>
		<td><span style='color: green'>.xEp.cU.</span></td>
		<td><span style='color: green'>.xEp.cU.</span></td>
		<td><span style='color: green'>.xEp.cU.</span></td>
		<td><span style='color: green'>.xEp.cU.</span></td>
	</tr>
	<tr>
		<td>mExE</td>
		<td>.mE.xE.</td>
		<td><span style='color: red'>emmm....Ok</span></td>
		<td><span style='color: red'>.mE.EE.E.</span></td>
		<td><span style='color: red'>.mExxE..</span></td>
		<td><span style='color: green'>.mE.xE.</span></td>
		<td><span style='color: green'>.mE.xE.</span></td>
		<td><span style='color: green'>.mE.xE.</span></td>
		<td><span style='color: green'>.mE.xE.</span></td>
		<td><span style='color: green'>.mE.xE.</span></td>
		<td><span style='color: green'>.mE.xE.</span></td>
		<td><span style='color: green'>.mE.xE.</span></td>
		<td><span style='color: green'>.mE.xE.</span></td>
	</tr>
	<tr>
		<td>UUUEE</td>
		<td>.U.U.U.E.E.</td>
		<td><span style='color: red'>emmm....Ok</span></td>
		<td><span style='color: red'>.U.UU.E.E..</span></td>
		<td><span style='color: red'>.U.U.EE.</span></td>
		<td><span style='color: red'>.U.U.U.E.</span></td>
		<td><span style='color: green'>.U.U.U.E.E.</span></td>
		<td><span style='color: green'>.U.U.U.E.E.</span></td>
		<td><span style='color: green'>.U.U.U.E.E.</span></td>
		<td><span style='color: green'>.U.U.U.E.E.</span></td>
		<td><span style='color: green'>.U.U.U.E.E.</span></td>
		<td><span style='color: green'>.U.U.U.E.E.</span></td>
		<td><span style='color: green'>.U.U.U.E.E.</td></span>
	</tr>
	<tr>
		<td>Exppp</td>
		<td>.E.xEp.pEp.</td>
		<td><span style='color: red'>eNmmm....O</span></td>
		<td><span style='color: red'>.E.xEppEpp.</span></td>
		<td><span style='color: red'>.Ex.pEppEp.</span></td>
		<td><span style='color: green'>.E.xEp.pEp.</span></td>
		<td><span style='color: green'>.E.xEp.pEp.</span></td>
		<td><span style='color: green'>.E.xEp.pEp.</span></td>
		<td><span style='color: green'>.E.xEp.pEp.</span></td>
		<td><span style='color: green'>.E.xEp.pEp.</span></td>
		<td><span style='color: green'>.E.xEp.pEp.</span></td>
		<td><span style='color: green'>.E.xEp.pEp.</span></td>
		<td><span style='color: green'>.E.xEp.pEp.</span></td> 
	</tr>
	<tr>
		<td>UpEUc</td>
		<td>.U.pE.Uc.</td>
		<td><span style='color: red'>emmm....O</td></span>
		<td><span style='color: red'>.U..pE.E...</span></td>
		<td><span style='color: red'>.U.pE.U..</span></td>
		<td><span style='color: red'>.U.pE.cc.</span></td>
		<td><span style='color: green'>.U.pE.Uc.</span></td>
		<td><span style='color: green'>.U.pE.Uc.</span></td>
		<td><span style='color: green'>.U.pE.Uc.</span></td>
		<td><span style='color: green'>.U.pE.Uc.</span></td>
		<td><span style='color: green'>.U.pE.Uc.</span></td>
		<td><span style='color: green'>.U.pE.Uc.</span></td>
		<td><span style='color: green'>.U.pE.Uc.</span></td>
	</tr>
	<tr>
		<td>EUUpm</td>
		<td>.E.U.U.pEm.</td>
		<td><span style='color: red'>emmm....Ok</span></td>
		<td><span style='color: red'>.U.E..E..E.</span></td>
		<td><span style='color: red'>.E.U.pEp.</span></td>
		<td><span style='color: green'>.E.U.U.pEm.</span></td>
		<td><span style='color: green'>.E.U.U.pEm.</span></td>
		<td><span style='color: green'>.E.U.U.pEm.</span></td>
		<td><span style='color: green'>.E.U.U.pEm.</span></td>
		<td><span style='color: green'>.E.U.U.pEm.</span></td>
		<td><span style='color: green'>.E.U.U.pEm.</span></td>
		<td><span style='color: green'>.E.U.U.pEm.</span></td>
		<td><span style='color: green'>.E.U.U.pEm.</span></td>
	</tr>
</table></div>

<div class="outertable" id="thousands3">

<table  class="thousands">
	<tr>
		<th>input</th>
		<th>correct output</th>
		<th>0 iterations</th>
		<th>1,000 iterations</th>
		<th>2,000 iterations</th>
		<th>3,000 iterations</th>
		<th>4,000 iterations</th>
		<th>5,000 iterations</th>
		<th>6,000 iterations</th>
		<th>7,000 iterations</th>
		<th>8,000 iterations</th>
		<th>9,000 iterations</th>
		<th>10,000 iterations</th>
	</tr>
	<tr>
		<td>Aktt</td>
		<td>.kAk.tUt.</td>
		<td><span style='color: red'>U.kA.kkU..</span></td>
		<td><span style='color: red'>.kA.tUt.</span></td>
		<td><span style='color: red'>.kAk.UUt.</span></td>
		<td><span style='color: green'>.kAk.tUt.</span></td>
		<td><span style='color: green'>.kAk.tUt.</span></td>
		<td><span style='color: green'>.kAk.tUt.</span></td>
		<td><span style='color: green'>.kAk.tUt.</span></td>
		<td><span style='color: green'>.kAk.tUt.</span></td>
		<td><span style='color: green'>.kAk.tUt.</span></td>
		<td><span style='color: green'>.kAk.tUt.</span></td>
		<td><span style='color: green'>.kAk.tUt.</span></td>
	</tr>
	<tr>
		<td>aukk</td>
		<td>.ka.ku.kUk.</td>
		<td><span style='color: red'>UU.kkU..k</span></td>
		<td><span style='color: red'>.ka.kukk</span></td>
		<td><span style='color: green'>.ka.ku.kUk.</span></td>
		<td><span style='color: green'>.ka.ku.kUk.</span></td>
		<td><span style='color: green'>.ka.ku.kUk.</span></td>
		<td><span style='color: green'>.ka.ku.kUk.</span></td>
		<td><span style='color: green'>.ka.ku.kUk.</span></td>
		<td><span style='color: green'>.ka.ku.kUk.</span></td>
		<td><span style='color: green'>.ka.ku.kUk.</span></td>
		<td><span style='color: green'>.ka.ku.kUk.</span></td>
		<td><span style='color: green'>.ka.ku.kUk.</span></td>
	</tr>
	<tr>
		<td>Uta</td>
		<td>.kU.ta.</td>
		<td><span style='color: red'>UU.kkU..kk</span></td>
		<td><span style='color: red'>.kU.ka..</span></td>
		<td><span style='color: green'>.kU.ta.</span></td>
		<td><span style='color: green'>.kU.ta.</span></td>
		<td><span style='color: green'>.kU.ta.</span></td>
		<td><span style='color: green'>.kU.ta.</span></td>
		<td><span style='color: green'>.kU.ta.</span></td>
		<td><span style='color: green'>.kU.ta.</span></td>
		<td><span style='color: green'>.kU.ta.</span></td>
		<td><span style='color: green'>.kU.ta.</span></td>
		<td><span style='color: green'>.kU.ta.</span></td>
	</tr>
	<tr>
		<td>tak</td>
		<td>.tak.</td>
		<td><span style='color: red'>UU.kkU..kk</td></span>
		<td><span style='color: red'>.tU..</span></td>
		<td><span style='color: red'>.ta.k</span></td>
		<td><span style='color: green'>.tak.</span></td>
		<td><span style='color: green'>.tak.</span></td>
		<td><span style='color: green'>.tak.</span></td>
		<td><span style='color: green'>.tak.</span></td> 
		<td><span style='color: green'>.tak.</span></td>
		<td><span style='color: green'>.tak.</span></td>
		<td><span style='color: green'>.tak.</span></td>
		<td><span style='color: red'>.ta.kak.</span></td>
	</tr>
	<tr>
		<td>ttktA</td>
		<td>.tU.tUk.tA.</td>
		<td><span style='color: red'>nkaaaaaaaa</span></td>
		<td><span style='color: red'>.tU.tUt.</span></td>
		<td><span style='color: red'>.tU..Ut.kA.</span></td>
		<td><span style='color: red'>.tU.tUt.tA.</span></td>
		<td><span style='color: green'>.tU.tUk.tA.</span></td>
		<td><span style='color: green'>.tU.tUk.tA.</span></td>
		<td><span style='color: green'>.tU.tUk.tA.</span></td> 
		<td><span style='color: green'>.tU.tUk.tA.</span></td>
		<td><span style='color: green'>.tU.tUk.tA.</span></td>
		<td><span style='color: green'>.tU.tUk.tA.</span></td>
		<td><span style='color: green'>.tU.tUk.tA.</span></td>
	</tr>
	<tr>
		<td>UtAUa</td>
		<td>.kU.tA.kU.ka.</td>
		<td><span style='color: red'>UU.kkU..kk</span></td>
		<td><span style='color: red'>.kU.kU.ka.ka.</span></td>
		<td><span style='color: red'>.kU.tA.kA.ka.</span></td>
		<td><span style='color: green'>.kU.tA.kU.ka.</span></td>
		<td><span style='color: green'>.kU.tA.kU.ka.</span></td>
		<td><span style='color: green'>.kU.tA.kU.ka.</span></td>
		<td><span style='color: green'>.kU.tA.kU.ka.</span></td>
		<td><span style='color: green'>.kU.tA.kU.ka.</span></td>
		<td><span style='color: green'>.kU.tA.kU.ka.</span></td>
		<td><span style='color: green'>.kU.tA.kU.ka.</span></td>
		<td><span style='color: green'>.kU.tA.kU.ka.</span></td>
	</tr>
	<tr>
		<td>kuUta</td>
		<td>.ku.kU.ta.</td>
		<td><span style='color: red'>U.kU.kkU..</span></td>
		<td><span style='color: red'>.kU.kU.ka..</span></td>
		<td><span style='color: red'>.ku.kU.tU.</span></td>
		<td><span style='color: green'>.ku.kU.ta.</span></td>
		<td><span style='color: green'>.ku.kU.ta.</span></td>
		<td><span style='color: green'>.ku.kU.ta.</span></td>
		<td><span style='color: green'>.ku.kU.ta.</span></td>
		<td><span style='color: green'>.ku.kU.ta.</span></td>
		<td><span style='color: green'>.ku.kU.ta.</span></td>
		<td><span style='color: green'>.ku.kU.ta.</span></td>
		<td><span style='color: green'>.ku.kU.ta.</span></td>
	</tr>
	<tr>
		<td>katta</td>
		<td>.kat.ta.</td>
		<td><span style='color: red'>U.kU.kkU..</span></td>
		<td><span style='color: red'>.ka.tat..</span></td>
		<td><span style='color: green'>.kat.ta.</span></td>
		<td><span style='color: green'>.kat.ta.</span></td>
		<td><span style='color: green'>.kat.ta.</span></td>
		<td><span style='color: green'>.kat.ta.</span></td>
		<td><span style='color: green'>.kat.ta.</span></td>
		<td><span style='color: green'>.kat.ta.</span></td>
		<td><span style='color: green'>.kat.ta.</span></td>
		<td><span style='color: green'>.kat.ta.</span></td>
		<td><span style='color: green'>.kat.ta.</span></td>
	</tr>
	<tr>
		<td>U</td>
		<td>.kU.</td>
		<td><span style='color: red'>UUkkkaaaaa</span></td>
		<td><span style='color: green'>.kU.</span></td>
		<td><span style='color: green'>.kU.</span></td>
		<td><span style='color: green'>.kU.</span></td>
		<td><span style='color: green'>.kU.</span></td>
		<td><span style='color: green'>.kU.</span></td>
		<td><span style='color: green'>.kU.</span></td>
		<td><span style='color: green'>.kU.</span></td>
		<td><span style='color: green'>.kU.</span></td>
		<td><span style='color: green'>.kU.</span></td>
		<td></td>
	</tr>
	<tr>
		<td>kattu</td>
		<td>.kat.tu.</td>
		<td><span style='color: red'>U.kkU..kkU</span></td>
		<td><span style='color: red'>.ka.tut</span></td>
		<td><span style='color: red'>.kat.ku.</span></td>
		<td><span style='color: green'>.kat.tu.</span></td>
		<td><span style='color: green'>.kat.tu.</span></td>
		<td><span style='color: green'>.kat.tu.</span></td>
		<td><span style='color: green'>.kat.tu.</span></td>
		<td><span style='color: green'>.kat.tu.</span></td>
		<td><span style='color: green'>.kat.tu.</span></td>
		<td><span style='color: green'>.kat.tu.</span></td>
		<td><span style='color: green'>.kat.tu.</span></td>
	</tr>
</table></div>

<div class="outertable" id="thousands4">
<table  class="thousands">
	<tr>
		<th>input</th>
		<th>correct output</th>
		<th>0 iterations</th>
		<th>1,000 iterations</th>
		<th>2,000 iterations</th>
		<th>3,000 iterations</th>
		<th>4,000 iterations</th>
		<th>5,000 iterations</th>
		<th>6,000 iterations</th>
		<th>7,000 iterations</th>
		<th>8,000 iterations</th>
		<th>9,000 iterations</th>
		<th>10,000 iterations</th>
	</tr>
	<tr>
		<td>btubo</td>
		<td>.bU.tu.bo.</td>
		<td><span style='color: red'>uttjutjutj</span></td>
		<td><span style='color: red'>.bU.bo.fo.</span></td>
		<td><span style='color: green'>.bU.tu.bo.</span></td>
		<td><span style='color: green'>.bU.tu.bo.</span></td>
		<td><span style='color: green'>.bU.tu.bo.</span></td>
		<td><span style='color: green'>.bU.tu.bo.</span></td>
		<td><span style='color: green'>.bU.tu.bo.</span></td>
		<td><span style='color: green'>.bU.tu.bo.</span></td>
		<td><span style='color: green'>.bU.tu.bo.</span></td>
		<td><span style='color: green'>.bU.tu.bo.</span></td>
		<td><span style='color: green'>.bU.tu.bo.</span></td>
	</tr>
	<tr>
		<td>uuutb</td>
		<td>.fu.fu.fu.tU.bU.</td>
		<td><span style='color: red'>tNujutjutj</span></td>
		<td><span style='color: red'>.fu.fu.fu.bU.bU.</span></td>
		<td><span style='color: red'>.fu.fu.tU.bU.bU.</span></td>
		<td><span style='color: red'>.fu.fu.tU.bU.bU.</span></td>
		<td><span style='color: red'>.fu.fu.fu.tU.</span></td>
		<td><span style='color: green'>.fu.fu.fu.tU.bU.</span></td>
		<td><span style='color: red'>.fu.fu.tU.bU.bU.</span></td>
		<td><span style='color: red'>.fu.fu.tU.bU.bU.</span></td>
		<td><span style='color: green'>.fu.fu.fu.tU.bU.</span></td>
		<td><span style='color: green'>.fu.fu.fu.tU.bU.</span></td>
		<td><span style='color: green'>.fu.fu.fu.tU.bU.</span></td>
	</tr>
	<tr>
		<td>fffbf</td>
		<td>.fU.fU.fU.bU.fU.</td>
		<td><span style='color: red'>jutjutjutj</span></td>
		<td><span style='color: red'>.fU.fU.bU.bU.</span></td>
		<td><span style='color: red'>.fU.fU.bU.fU.</span></td>
		<td><span style='color: green'>.fU.fU.fU.bU.fU.</span></td>
		<td><span style='color: green'>.fU.fU.fU.fU.fU.</span></td>
		<td><span style='color: red'>.fU.fU.bU.fU.fU.</span></td>
		<td><span style='color: red'>.fU.fU.bU.bU.fU.</span></td>
		<td><span style='color: green'>.fU.fU.fU.bU.fU.</span></td>
		<td><span style='color: green'>.fU.fU.fU.bU.fU.</span></td>
		<td><span style='color: green'>.fU.fU.fU.bU.fU.</span></td>
		<td><span style='color: green'>.fU.fU.fU.bU.fU.</span></td>
	</tr>
	<tr>
		<td>votuv</td>
		<td>.vo.tu.vU.</td>
		<td><span style='color: red'>uttjutjutj</span></td>
		<td><span style='color: red'>.vo.vo.vU.vU.</span></td>
		<td><span style='color: green'>.vo.tu.vU.</span></td>
		<td><span style='color: green'>.vo.tu.vU.</span></td>
		<td><span style='color: green'>.vo.tu.vU.</span></td>
		<td><span style='color: green'>.vo.tu.vU.</span></td>
		<td><span style='color: green'>.vo.tu.vU.</span></td>
		<td><span style='color: green'>.vo.tu.vU.</span></td> 
		<td><span style='color: green'>.vo.tu.vU.</span></td>
		<td><span style='color: green'>.vo.tu.vU.</span></td>
		<td><span style='color: green'>.vo.tu.vU.</span></td>
	</tr>
	<tr>
		<td>uoUUf</td>
		<td>.fu.fo.fU.fU.fU.</td>
		<td><span style='color: red'>jutjutjutj</span></td>
		<td><span style='color: green'>.fu.fo.fU.fU.fU.</span></td>
		<td><span style='color: red'>.fu.fo.fU.fU.</span></td>
		<td><span style='color: green'>.fu.fo.fU.fU.fU.</span></td>
		<td><span style='color: green'>.fu.fo.fU.fU.fU.</span></td>
		<td><span style='color: green'>.fu.fo.fU.fU.fU.</span></td>
		<td><span style='color: green'>.fu.fo.fU.fU.fU.</span></td>
		<td><span style='color: green'>.fu.fo.fU.fU.fU.</span></td>
		<td><span style='color: green'>.fu.fo.fU.fU.fU.</span></td>
		<td><span style='color: green'>.fu.fo.fU.fU.fU.</span></td>
		<td><span style='color: green'>.fu.fo.fU.fU.fU.</span></td>
	</tr>
	<tr>
		<td>vuufu</td>
		<td>.vu.fu.fu.</td>
		<td><span style='color: red'>tNujutjutj</span></td>
		<td><span style='color: green'>.vu.fu.fu.</span></td>
		<td><span style='color: green'>.vu.fu.fu.</span></td>
		<td><span style='color: green'>.vu.fu.fu.</span></td>
		<td><span style='color: green'>.vu.fu.fu.</span></td>
		<td><span style='color: green'>.vu.fu.fu.</span></td>
		<td><span style='color: green'>.vu.fu.fu.</span></td>
		<td><span style='color: green'>.vu.fu.fu.</span></td> 
		<td><span style='color: green'>.vu.fu.fu.</span></td>
		<td><span style='color: green'>.vu.fu.fu.</span></td>
		<td><span style='color: green'>.vu.fu.fu.</span></td>
	</tr>
	<tr>
		<td>ubuu</td>
		<td>.fu.bu.fu.</td>
		<td><span style='color: red'>rZAbwjutju</span></td>
		<td><span style='color: green'>.fu.bu.fu.</span></td>
		<td><span style='color: green'>.fu.bu.fu.</span></td>
		<td><span style='color: green'>.fu.bu.fu.</span></td>
		<td><span style='color: green'>.fu.bu.fu.</span></td>
		<td><span style='color: green'>.fu.bu.fu.</span></td>
		<td><span style='color: green'>.fu.bu.fu.</span></td>
		<td><span style='color: green'>.fu.bu.fu.</span></td>
		<td><span style='color: green'>.fu.bu.fu.</span></td>
		<td><span style='color: green'>.fu.bu.fu.</span></td>
		<td><span style='color: green'>.fu.bu.fu.</span></td>
	</tr>
	<tr>
		<td>fvuof</td>
		<td>.fU.vu.fo.fU.</td>
		<td><span style='color: red'>jutjutjutj</span></td>
		<td><span style='color: red'>.fU.fo.fU.fU.</span></td>
		<td><span style='color: green'>.fU.vu.fo.fU.</span></td>
		<td><span style='color: green'>.fU.vu.fo.fU.</span></td>
		<td><span style='color: green'>.fU.vu.fo.fU.</span></td>
		<td><span style='color: green'>.fU.vu.fo.fU.</span></td>
		<td><span style='color: green'>.fU.vu.fo.fU.</span></td>
		<td><span style='color: green'>.fU.vu.fo.fU.</span></td>
		<td><span style='color: green'>.fU.vu.fo.fU.</span></td>
		<td><span style='color: green'>.fU.vu.fo.fU.</span></td>
		<td><span style='color: green'>.fU.vu.fo.fU.</span></td>
	</tr>
	<tr>
		<td>vuofu</td>
		<td>.vu.fo.fu.</td>
		<td><span style='color: red'>tNujutjutj</span></td>
		<td><span style='color: red'>.vu.fo.fu.fU.</span></td>
		<td><span style='color: green'>.vu.fo.fu.</span></td>
		<td><span style='color: green'>.vu.fo.fu.</span></td>
		<td><span style='color: green'>.vu.fo.fu.</span></td>
		<td><span style='color: green'>.vu.fo.fu.</span></td>
		<td><span style='color: green'>.vu.fo.fu.</span></td>
		<td><span style='color: green'>.vu.fo.fu.</span></td>
		<td><span style='color: green'>.vu.fo.fu.</span></td>
		<td><span style='color: green'>.vu.fo.fu.</span></td>
		<td><span style='color: green'>.vu.fo.fu.</span></td>
	</tr>
	<tr>
		<td>ootUU</td>
		<td>.fo.fo.tU.fU.</td>
		<td><span style='color: red'>ffffffffff</span></td>
		<td><span style='color: red'>.fo.fo.fU.tU.tU.</span></td>
		<td><span style='color: green'>.fo.fo.tU.fU.</span></td>
		<td><span style='color: green'>.fo.fo.tU.fU.</span></td>
		<td><span style='color: green'>.fo.fo.tU.fU.</span></td>
		<td><span style='color: green'>.fo.fo.tU.fU.</span></td>
		<td><span style='color: green'>.fo.to.tU.fU.</span></td>
		<td><span style='color: green'>.fo.to.tU.fU.</span></td> 
		<td><span style='color: green'>.fo.to.tU.fU.</span></td>
		<td><span style='color: green'>.fo.to.tU.fU.</span></td>
		<td><span style='color: green'>.fo.to.tU.fU.</span></td>
	</tr>
</table></div>

<div class="outertable" id="thousands5">
<table  class="thousands">
	<tr>
		<th>input</th>
		<th>correct output</th>
		<th>0 iterations</th>
		<th>1,000 iterations</th>
		<th>2,000 iterations</th>
		<th>3,000 iterations</th>
		<th>4,000 iterations</th>
		<th>5,000 iterations</th>
		<th>6,000 iterations</th>
		<th>7,000 iterations</th>
		<th>8,000 iterations</th>
		<th>9,000 iterations</th>
		<th>10,000 iterations</th>
	</tr>
	<tr>
		<td>Ebhhh</td>
		<td>.Eh.</td>
		<td><span style='color: red'>iibEuccEcc</span></td>
		<td><span style='color: green'>.Eh.</span></td>
		<td><span style='color: red'>.Eh.hh.</span></td>
		<td><span style='color: green'>.Eh.</span></td>
		<td><span style='color: green'>.Eh.</span></td>
		<td><span style='color: green'>.Eh.</span></td> 
		<td><span style='color: green'>.Eh.</span></td>
		<td><span style='color: green'>.Eh.</span></td>
		<td><span style='color: green'>.Eh.</span></td>
		<td><span style='color: green'>.Eh.</span></td>
		<td><span style='color: green'>.Eh.</span></td>
	</tr>
	<tr>
		<td>AAr</td>
		<td>.A.Ar.</td>
		<td><span style='color: red'>nquccEccEc</span></td>
		<td><span style='color: red'>.A.AA.</span></td>
		<td><span style='color: red'>.A.A.Ar.</span></td>
		<td><span style='color: green'>.A.Ar.</span></td>
		<td><span style='color: green'>.A.Ar.</span></td>
		<td><span style='color: green'>.A.Ar.</span></td>
		<td><span style='color: green'>.A.Ar.</span></td>
		<td><span style='color: green'>.A.Ar.</span></td>
		<td><span style='color: green'>.A.Ar.</span></td>
		<td><span style='color: green'>.A.Ar.</span></td>
		<td><span style='color: green'>.A.Ar.</span></td>
	</tr>
	<tr>
		<td>EhrA</td>
		<td>.Eh.rA.</td>
		<td><span style='color: red'>bEuccEccEc</span></td>
		<td><span style='color: red'>.Er.AA.</span></td>
		<td><span style='color: red'>.Er.rA.</span></td>
		<td><span style='color: red'>.Eh.hA.</span></td>
		<td><span style='color: green'>.Er.rA.</span></td>
		<td><span style='color: green'>.Eh.rA.</span></td>
		<td><span style='color: green'>.Eh.rA.</span></td>
		<td><span style='color: green'>.Eh.rA.</span></td>
		<td><span style='color: green'>.Eh.rA.</span></td>
		<td><span style='color: green'>.Eh.rA.</span></td>
		<td><span style='color: green'>.Eh.rA.</span></td>
	</tr>
	<tr>
		<td>AhrhA</td>
		<td>.Ar.hA.</td>
		<td><span style='color: red'>xuccEccEcc</span></td>
		<td><span style='color: red'>.A.AA.</span></td>
		<td><span style='color: red'>.Ah.hA..A.</span></td>
		<td><span style='color: red'>.Ah.hA.</span></td>
		<td><span style='color: red'>.Ah.rA.</span></td>
		<td><span style='color: red'>.Ah.hA.</span></td>
		<td><span style='color: green'>.Ar.hA.</span></td>
		<td><span style='color: green'>.Ar.hA.</span></td>
		<td><span style='color: green'>.Ar.hA.</span></td>
		<td><span style='color: green'>.Ar.hA.</span></td>
		<td><span style='color: green'>.Ar.hA.</span></td>
	</tr>
	<tr>
		<td>AAhEE</td>
		<td>.A.A.hE.E.</td>
		<td><span style='color: red'>ujccEccEcc</span></td>
		<td><span style='color: red'>.A.A.EE.</span></td>
		<td><span style='color: red'>.A.A.rE.E.</span></td>
		<td><span style='color: red'>.A.A.hE.</span></td>
		<td><span style='color: green'>.A.A.hE.E.</span></td>
		<td><span style='color: red'>.A.A.hA.E.</span></td>
		<td><span style='color: green'>.A.A.hE.E.</span></td>
		<td><span style='color: green'>.A.A.hE.E.</span></td> 
		<td><span style='color: green'>.A.A.hE.E.</span></td> 
		<td><span style='color: green'>.A.A.hE.E.</span></td> 
		<td><span style='color: green'>.A.A.hE.E.</span></td> 
	</tr>
	<tr>
		<td>rhA</td>
		<td>.hA.</td>
		<td><span style='color: red'>xuccEccEcc</span></td>
		<td><span style='color: green'>.hA.</span></td>
		<td><span style='color: green'>.hA.</span></td>
		<td><span style='color: green'>.hA.</span></td>
		<td><span style='color: green'>.hA.</span></td>
		<td><span style='color: green'>.hA.</span></td>
		<td><span style='color: green'>.hA.</span></td>
		<td><span style='color: green'>.hA.</span></td>
		<td><span style='color: green'>.hA.</span></td>
		<td><span style='color: green'>.hA.</span></td>
		<td><span style='color: green'>.hA.</span></td>
	</tr>
	<tr>
		<td>EArrA</td>
		<td>.E.Ar.rA.</td>
		<td><span style='color: red'>xuccEccEcc</span></td>
		<td><span style='color: red'>.E.AA.AA.</span></td>
		<td><span style='color: green'>.E.Ar.rA.</span></td>
		<td><span style='color: green'>.E.Ar.rA.</span></td>
		<td><span style='color: green'>.E.Ar.rA.</span></td>
		<td><span style='color: green'>.E.Ar.rA.</span></td>
		<td><span style='color: green'>.E.Ar.rA.</span></td>
		<td><span style='color: green'>.E.Ar.rA.</span></td>
		<td><span style='color: green'>.E.Ar.rA.</span></td>
		<td><span style='color: green'>.E.Ar.rA.</span></td>
		<td><span style='color: green'>.E.Ar.rA.</span></td>
	</tr>
	<tr>
		<td>AEErE</td>
		<td>.A.E.E.rE.</td>
		<td><span style='color: red'>ibEuccEccE</span></td>
		<td><span style='color: red'>.A.E.E..</span></td>
		<td><span style='color: red'>.A.E.rE.E.</span></td>
		<td><span style='color: red'>.A.E.EE.E.</span></td>
		<td><span style='color: green'>.A.E.E.rE.</span></td>
		<td><span style='color: green'>.A.E.E.rE.</span></td>
		<td><span style='color: green'>.A.E.E.rE.</span></td>
		<td><span style='color: green'>.A.E.E.rE.</span></td>
		<td><span style='color: green'>.A.E.E.rE.</span></td>
		<td><span style='color: green'>.A.E.E.rE.</span></td>
		<td><span style='color: green'>.A.E.E.rE.</span></td>
	</tr>
	<tr>
		<td>EEEE</td>
		<td>.E.E.E.E.</td>
		<td><span style='color: red'>ujccEccEcc</span></td>
		<td><span style='color: green'>.E.E.E.E.</span></td>
		<td><span style='color: green'>.E.E.E.E.</span></td>
		<td><span style='color: green'>.E.E.E.E..</span></td>
		<td><span style='color: green'>.E.E.E.E.</span></td>
		<td><span style='color: green'>.E.E.E.E.</span></td>
		<td><span style='color: green'>.E.E.E.E.</span></td>
		<td><span style='color: green'>.E.E.E.E.</span></td>
		<td><span style='color: green'>.E.E.E.E.</span></td>
		<td><span style='color: green'>.E.E.E.E.</span></td>
		<td><span style='color: green'>.E.E.E.E.</span></td>
	</tr>
	<tr>
		<td>hrAA</td>
		<td>.rA.A.</td>
		<td><span style='color: red'>xxuccEccEc</span></td>
		<td><span style='color: green'>.rA.A.</span></td>
		<td><span style='color: green'>.rA.A.</span></td>
		<td><span style='color: green'>.rA.A.</span></td>
		<td><span style='color: green'>.rA.A.</span></td>
		<td><span style='color: green'>.rA.A.</span></td>
		<td><span style='color: green'>.rA.A.</span></td>
		<td><span style='color: green'>.rA.A.</span></td>
		<td><span style='color: green'>.rA.A.</span></td>
		<td><span style='color: green'>.rA.A.</span></td>
		<td><span style='color: green'>.rA.A.</span></td>
	</tr>
</table></div>

<div class="outertable" id="thousands6">
<table  class="thousands">
	<tr>
		<th>input</th>
		<th>correct output</th>
		<th>0 iterations</th>
		<th>1,000 iterations</th>
		<th>2,000 iterations</th>
		<th>3,000 iterations</th>
		<th>4,000 iterations</th>
		<th>5,000 iterations</th>
		<th>6,000 iterations</th>
		<th>7,000 iterations</th>
		<th>8,000 iterations</th>
		<th>9,000 iterations</th>
		<th>10,000 iterations</th>
	</tr>
	<tr>
		<td>rUUUr</td>
		<td>.rU.U.U.re.</td>
		<td><span style='color: red'>fddddddddd</span></td>
		<td><span style='color: red'>.rU.U.re.</span></td>
		<td><span style='color: green'>.rU.U.U.re.</span></td>
		<td><span style='color: green'>.rU.U.U.re.</span></td>
		<td><span style='color: green'>.rU.U.U.re.</span></td>
		<td><span style='color: red'>.rU.U.U.U.e.</span></td>
		<td><span style='color: green'>.rU.U.U.re.</span></td>
		<td><span style='color: green'>.rU.U.U.re.</span></td>
		<td><span style='color: green'>.rU.U.U.re.</span></td>
		<td><span style='color: green'>.rU.U.U.re.</span></td>
		<td><span style='color: green'>.rU.U.U.re.</span></td>
	</tr>
	<tr>
		<td>UU</td>
		<td>.U.U.</td>
		<td><span style='color: red'>xcrfdddddd</span></td>
		<td><span style='color: green'>.U.U.</span></td>
		<td><span style='color: green'>.U.U.</span></td>
		<td><span style='color: green'>.U.U.</span></td>
		<td><span style='color: red'>.U.</span></td>
		<td><span style='color: green'>.U.U.</span></td>
		<td><span style='color: red'>.U.</span></td>
		<td><span style='color: red'>.U.</span></td>
		<td><span style='color: red'>.U.</span></td>
		<td><span style='color: red'>.U.</span></td>
		<td><span style='color: red'>.U.</span></td>
	</tr>
	<tr>
		<td>heee</td>
		<td>.he.e.e.</td>
		<td><span style='color: red'>xbxbkxbkxb</span></td>
		<td><span style='color: green'>.he.e.e.</span></td>
		<td><span style='color: green'>.he.e.e.</span></td>
		<td><span style='color: green'>.he.e.e.</span></td>
		<td><span style='color: green'>.he.e.e.</span></td>
		<td><span style='color: red'>.he.e.e.e.</span></td>
		<td><span style='color: green'>.he.e.e.</span></td>
		<td><span style='color: green'>.he.e.e.</span></td>
		<td><span style='color: green'>.he.e.e.</span></td>
		<td><span style='color: green'>.he.e.e.</span></td>
		<td><span style='color: green'>.he.e.e.</span></td>
	</tr>
	<tr>
		<td>eger</td>
		<td>.e.ge.re.</td>
		<td><span style='color: red'>ehcrfddddd</span></td>
		<td><span style='color: green'>.e.ge.re.</span></td>
		<td><span style='color: green'>.e.ge.re.</span></td>
		<td><span style='color: green'>.e.ge.re.</span></td>
		<td><span style='color: green'>.e.ge.re.</span></td>
		<td><span style='color: green'>.e.ge.re.</span></td>
		<td><span style='color: green'>.e.ge.re.</span></td>
		<td><span style='color: green'>.e.ge.re.</span></td> 
		<td><span style='color: green'>.e.ge.re.</span></td>
		<td><span style='color: green'>.e.ge.re.</span></td>
		<td><span style='color: green'>.e.ge.re.</span></td>
	</tr>
	<tr>
		<td>heeUU</td>
		<td>.he.e.U.U.</td>
		<td><span style='color: red'>xSxcrfdddd</span></td>
		<td><span style='color: red'>.he.e.e...</span></td>
		<td><span style='color: green'>.he.e.U.U.</span></td>
		<td><span style='color: green'>.he.e.U.U.</span></td>
		<td><span style='color: green'>.he.e.U.U.</span></td>
		<td><span style='color: green'>.he.e.U.U.</span></td>
		<td><span style='color: green'>.he.e.U.U.</span></td>
		<td><span style='color: green'>.he.e.U.U.</span></td>
		<td><span style='color: green'>.he.e.U.U.</span></td>
		<td><span style='color: green'>.he.e.U.U.</span></td>
		<td><span style='color: green'>.he.e.U.U.</span></td>
	</tr>
	<tr>
		<td>heUh</td>
		<td>.he.U.he.</td>
		<td><span style='color: red'>xtxOkkxkkx</span></td>
		<td><span style='color: red'>.he.h..e.</span></td>
		<td><span style='color: green'>.he.U.he.</span></td>
		<td><span style='color: green'>.he.U.he.</span></td>
		<td><span style='color: green'>.he.U.he.</span></td>
		<td><span style='color: red'>.hU.U.e.he.</span></td>
		<td><span style='color: green'>.he.U.he.</span></td>
		<td><span style='color: green'>.he.U.he.</span></td>
		<td><span style='color: green'>.he.U.he.</span></td>
		<td><span style='color: green'>.he.U.he.</span></td>
		<td><span style='color: green'>.he.U.he.</span></td>
	</tr>
	<tr>
		<td>rrUU</td>
		<td>.re.rU.U.</td>
		<td><span style='color: red'>xtxOkkxkkx</span></td>
		<td><span style='color: red'>.re.rU.UU.</span></td>
		<td><span style='color: green'>.re.rU.U.</span></td>
		<td><span style='color: green'>.re.rU.U.</span></td>
		<td><span style='color: green'>.re.rU.U.</span></td>
		<td><span style='color: red'>.re.rU.U.U.</span></td>
		<td><span style='color: green'>.re.rU.U.</span></td>
		<td><span style='color: green'>.re.rU.U.</span></td>
		<td><span style='color: green'>.re.rU.U.</span></td>
		<td><span style='color: green'>.re.rU.U.</span></td>
		<td><span style='color: green'>.re.rU.U.</span></td>
	</tr>
	<tr>
		<td>gr</td>
		<td>.ge.re.</td>
		<td><span style='color: red'>fddddddddd</span></td>
		<td><span style='color: green'>.ge.re.</span></td>
		<td><span style='color: green'>.ge.re.</span></td>
		<td><span style='color: green'>.ge.re.</span></td>
		<td><span style='color: green'>.ge.re.</span></td>
		<td><span style='color: green'>.ge.re.</span></td>
		<td><span style='color: green'>.ge.re.</span></td>
		<td><span style='color: green'>.ge.re.</span></td> 
		<td><span style='color: green'>.ge.re.</span></td>
		<td><span style='color: green'>.ge.re.</span></td>
		<td><span style='color: green'>.ge.re.</span></td>
	</tr>
	<tr>
		<td>grreg</td>
		<td>.ge.re.re.ge.</td>
		<td><span style='color: red'>fddddddddd</span></td>
		<td><span style='color: red'>.ge.re.ge.ge.</span></td>
		<td><span style='color: green'>.ge.re.re.ge.</span></td>
		<td><span style='color: green'>.ge.re.re.ge.</span></td>
		<td><span style='color: red'>.ge.re.ge.ge.</span></td>
		<td><span style='color: red'>.ge.re.re.ge.ge.</span></td>
		<td><span style='color: green'>.ge.re.re.ge.</span></td>
		<td><span style='color: red'>.ge.re.re.ge.ge.</span></td>
		<td><span style='color: green'>.ge.re.re.ge.</span></td>
		<td><span style='color: green'>.ge.re.re.ge.</span></td>
		<td><span style='color: green'>.ge.re.re.ge.</span></td>
	</tr>
	<tr>
		<td>UeerU</td>
		<td>.U.e.e.rU.</td>
		<td><span style='color: red'>xtxOkkxkkx</span></td>
		<td><span style='color: red'>.U.U.rU.U.</span></td>
		<td><span style='color: green'>.U.e.e.rU.</span></td>
		<td><span style='color: green'>.U.e.e.rU.</span></td>
		<td><span style='color: green'>.U.e.e.rU.</span></td>
		<td><span style='color: green'>.U.e.e.rU.</span></td>
		<td><span style='color: green'>.U.e.e.rU.</span></td>
		<td><span style='color: green'>.U.e.e.rU.</span></td>
		<td><span style='color: green'>.U.e.e.rU.</span></td>
		<td><span style='color: green'>.U.e.e.rU.</span></td> 
		<td><span style='color: green'>.U.e.e.rU.</span></td> 
	</tr>
</table></div>

<div class="outertable" id="thousands7">
<table  class="thousands">
	<tr>
		<th>input</th>
		<th>correct output</th>
		<th>0 iterations</th>
		<th>1,000 iterations</th>
		<th>2,000 iterations</th>
		<th>3,000 iterations</th>
		<th>4,000 iterations</th>
		<th>5,000 iterations</th>
		<th>6,000 iterations</th>
		<th>7,000 iterations</th>
		<th>8,000 iterations</th>
		<th>9,000 iterations</th>
		<th>10,000 iterations</th>
	</tr>
	<tr>
		<td>Uuru</td>
		<td>.ru.</td>
		<td><span style='color: red'>ssssssssss</span></td>
		<td><span style='color: green'>.ru.</span></td>
		<td><span style='color: green'>.ru.</span></td>
		<td><span style='color: green'>.ru.</span></td>
		<td><span style='color: green'>.ru.</span></td>
		<td><span style='color: green'>.ru.</span></td>
		<td><span style='color: green'>.ru.</span></td>
		<td><span style='color: green'>.ru.</span></td>
		<td><span style='color: green'>.ru.</span></td>
		<td><span style='color: green'>.ru.</span></td>
		<td><span style='color: green'>.ru.</span></td>
	</tr>
	<tr>
		<td>rUj</td>
		<td>.rU.</td>
		<td><span style='color: red'>jfffffffff</span></td>
		<td><span style='color: green'>.rU.</span></td>
		<td><span style='color: green'>.rU.</span></td>
		<td><span style='color: green'>.rU.</span></td>
		<td><span style='color: green'>.rU.</span></td>
		<td><span style='color: green'>.rU.</span></td>
		<td><span style='color: green'>.rU.</span></td>
		<td><span style='color: green'>.rU.</span></td>
		<td><span style='color: green'>.rU.</span></td>
		<td><span style='color: green'>.rU.</span></td>
		<td><span style='color: green'>.rU.</span></td>
	</tr>
	<tr>
		<td>udub</td>
		<td>.du.</td>
		<td><span style='color: red'>jfffffffff</span></td>
		<td><span style='color: green'>.du.</span></td>
		<td><span style='color: green'>.du.</span></td>
		<td><span style='color: green'>.du.</span></td>
		<td><span style='color: green'>.du.</span></td>
		<td><span style='color: green'>.du.</span></td>
		<td><span style='color: green'>.du.</span></td>
		<td><span style='color: green'>.du.</span></td>
		<td><span style='color: green'>.du.</span></td>
		<td><span style='color: green'>.du.</span></td>
		<td><span style='color: green'>.du.</span></td>
	</tr>
	<tr>
		<td>uUUUU</td>
		<td>&lt;empty&gt;</td>
		<td><span style='color: red'>kmffffffff</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
	</tr>
	<tr>
		<td>jUu</td>
		<td>.ju.</td>
		<td><span style='color: red'>kmffffffff</span></td>
		<td><span style='color: green'>.ju.</span></td>
		<td><span style='color: green'>.ju.</span></td>
		<td><span style='color: green'>.ju.</span></td>
		<td><span style='color: green'>.ju.</span></td>
		<td><span style='color: green'>.ju.</span></td>
		<td><span style='color: green'>.ju.</span></td>
		<td><span style='color: green'>.ju.</span></td>
		<td><span style='color: green'>.ju.</span></td>
		<td><span style='color: green'>.ju.</span></td>
		<td><span style='color: green'>.ju.</span></td>
	</tr>
	<tr>
		<td>uUuUu</td>
		<td>&lt;empty&gt;</td>
		<td><span style='color: red'>ssssssssss</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td> 
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
	</tr>
	<tr>
		<td>bbudU</td>
		<td>.bu.dU.</td>
		<td><span style='color: red'>kmffffffff</span></td>
		<td><span style='color: green'>.bu.dU.</span></td>
		<td><span style='color: green'>.bu.dU.</span></td>
		<td><span style='color: green'>.bu.dU.</span></td>
		<td><span style='color: green'>.bu.dU.</span></td>
		<td><span style='color: green'>.bu.dU.</span></td>
		<td><span style='color: green'>.bu.dU.</span></td>
		<td><span style='color: green'>.bu.dU.</span></td>
		<td><span style='color: green'>.bu.dU.</span></td>
		<td><span style='color: green'>.bu.dU.</span></td>
		<td><span style='color: green'>.bu.dU.</span></td>
	</tr>
	<tr>
		<td>Uubjj</td>
		<td>&lt;empty&gt;</td>
		<td><span style='color: red'>jfffffffff</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
	</tr>
	<tr>
		<td>UU</td>
		<td>&lt;empty&gt;</td>
		<td><span style='color: red'>kmffffffff</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
	</tr>
	<tr>
		<td>juUb</td>
		<td>.jU.</td>
		<td><span style='color: red'>kmffffffff</span></td>
		<td><span style='color: green'>.jU.</span></td>
		<td><span style='color: green'>.jU.</span></td>
		<td><span style='color: green'>.jU.</span></td>
		<td><span style='color: green'>.jU.</span></td>
		<td><span style='color: green'>.jU.</span></td>
		<td><span style='color: green'>.jU.</span></td>
		<td><span style='color: green'>.jU.</span></td>
		<td><span style='color: green'>.jU.</span></td>
		<td><span style='color: green'>.jU.</span></td>
		<td><span style='color: green'>.jU.</span></td>
	</tr>
</table></div>


<div class="outertable" id="thousands8">
<table  class="thousands">
	<tr>
		<th>input</th>
		<th>correct output</th>
		<th>0 iterations</th>
		<th>1,000 iterations</th>
		<th>2,000 iterations</th>
		<th>3,000 iterations</th>
		<th>4,000 iterations</th>
		<th>5,000 iterations</th>
		<th>6,000 iterations</th>
		<th>7,000 iterations</th>
		<th>8,000 iterations</th>
		<th>9,000 iterations</th>
		<th>10,000 iterations</th>
	</tr>
	<tr>
		<td>fUxa</td>
		<td>.fU.xa.</td>
		<td><span style='color: red'>g.xwiiss.l</span></td>
		<td><span style='color: red'>.fU.fU..</span></td>
		<td><span style='color: red'>.fU..a.</span></td>
		<td><span style='color: green'>.fU.xa.</span></td>
		<td><span style='color: green'>.fU.xa.</span></td>
		<td><span style='color: green'>.fU.xa.</span></td>
		<td><span style='color: green'>.fU.xa.</span></td>
		<td><span style='color: green'>.fU.xa.</span></td>
		<td><span style='color: green'>.fU.xa.</span></td>
		<td><span style='color: green'>.fU.xa.</span></td>
		<td><span style='color: green'>.fU.xa.</span></td>
	</tr>
	<tr>
		<td>ama</td>
		<td>.ma.</td>
		<td><span style='color: red'>..is.isrg.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
	</tr>
	<tr>
		<td>xxx</td>
		<td>&lt;empty&gt;</td>
		<td><span style='color: red'>Oeg.xwiiss</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
		<td><span style='color: green'>&lt;empty&gt;</span></td>
	</tr>
	<tr>
		<td>faxUU</td>
		<td>.fa.xU.</td>
		<td><span style='color: red'>eg.xwiisse</span></td>
		<td><span style='color: red'>.fU..U.</span></td>
		<td><span style='color: red'>.fU.fU.</span></td>
		<td><span style='color: green'>.fa.xU.</span></td>
		<td><span style='color: green'>.fa.xU.</span></td>
		<td><span style='color: green'>.fa.xU.</span></td>
		<td><span style='color: green'>.fa.xU.</span></td>
		<td><span style='color: green'>.fa.xU.</span></td>
		<td><span style='color: green'>.fa.xU.</span></td>
		<td><span style='color: green'>.fa.xU.</span></td>
		<td><span style='color: green'>.fa.xU.</span></td>
	</tr>
	<tr>
		<td>axUUU</td>
		<td>.xU.</td>
		<td><span style='color: red'>egk.xiiss.</span></td>
		<td><span style='color: red'>.xU..UU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
	</tr>
	<tr>
		<td>axU</td>
		<td>.xU.</td>
		<td><span style='color: red'>eg.xwiisse</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
		<td><span style='color: green'>.xU.</span></td>
	</tr>
	<tr>
		<td>Ufaaa</td>
		<td>.fa.</td>
		<td><span style='color: red'>..xiiss.ri</span></td>
		<td><span style='color: green'>.fa.</span></td>
		<td><span style='color: green'>.fa.</span></td>
		<td><span style='color: green'>.fa.</span></td>
		<td><span style='color: green'>.fa.</span></td>
		<td><span style='color: green'>.fa.</span></td>
		<td><span style='color: green'>.fa.</span></td>
		<td><span style='color: green'>.fa.</span></td>
		<td><span style='color: green'>.fa.</span></td>
		<td><span style='color: green'>.fa.</span></td>
		<td><span style='color: green'>.fa.</span></td>
	</tr>
	<tr>
		<td>xdUd</td>
		<td>.dUd.</td>
		<td><span style='color: red'>Uk.isrg.xi</span></td>
		<td><span style='color: green'>.dUd.</span></td>
		<td><span style='color: green'>.dUd.</span></td>
		<td><span style='color: green'>.dUd.</span></td>
		<td><span style='color: green'>.dUd.</span></td>
		<td><span style='color: green'>.dUd.</span></td>
		<td><span style='color: green'>.dUd.</span></td>
		<td><span style='color: green'>.dUd.</span></td>
		<td><span style='color: green'>.dUd.</span></td>
		<td><span style='color: green'>.dUd.</span></td>
		<td><span style='color: green'>.dUd.</span></td>
	</tr>
	<tr>
		<td>UxfdU</td>
		<td>.dU.</td>
		<td><span style='color: red'>f.r.iiss.r</span></td>
		<td><span style='color: green'>.dU.</span></td>
		<td><span style='color: green'>.dU.</span></td>
		<td><span style='color: green'>.dU.</span></td>
		<td><span style='color: green'>.dU.</span></td>
		<td><span style='color: green'>.dU.</span></td>
		<td><span style='color: green'>.dU.</span></td>
		<td><span style='color: green'>.dU.</span></td>
		<td><span style='color: green'>.dU.</span></td>
		<td><span style='color: green'>.dU.</span></td>
		<td><span style='color: green'>.dU.</span></td>
	</tr>
	<tr>
		<td>mxma</td>
		<td>.ma.</td>
		<td><span style='color: red'>..is.isrg.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
		<td><span style='color: green'>.ma.</span></td>
	</tr>
</table></div>

<div style="padding-top: 15px; padding-bottom: 40px; max-width: 600px; margin:auto; font-size: 13px;">
	<em>The performance of a randomly-initialized model after being trained on various numbers of examples. You may need to scroll to the right to see the full table.</em>
</div>


<h2>Generalization</h2>

<p>The main goal of our framework is to give a model a certain set of inductive biases. While the ability to learn from a small number of examples is one piece of evidence that a model has acquired some useful inductive biases, a more direct way to study a learner's inductive biases is through generalization: how does the learner handle novel types of examples?</p>

<p>The figure below shows how meta-learning facilitates three types of generalization: generalization to a novel length, generalization to novel symbols, and generalization to novel input structures (we refer to examples of the last category as <a href="https://www.oxfordreference.com/view/10.1093/oi/authority.20110803095959399">implicational universals</a>). In each case, we train our model on a training set which has certain types of examples withheld, then evaluate it on the withheld class of examples. Click the tabs above the figure to explore these three types of generalization.</p>

<div style="margin: auto;">
<div style="margin: auto; max-width:670px;">
<div id="lengthbtn" onClick="toggle_pos('length')" style="margin-left:20px; height: 40px; width: 60px;display: inline-block;border-style:solid;padding:10px;cursor:pointer;">Novel<br> lengths</div><div id="newbtn" onClick="toggle_pos('new')" style="height: 40px; width: 60px;display: inline-block;border-style:solid;padding:10px;cursor:pointer;">Novel symbols</div><div id="impbtn" onClick="toggle_pos('imp')" style="height: 40px; width: 90px;display: inline-block;border-style:solid;padding:10px;cursor:pointer;">Implicational universals</div>
</div>
</div>


<div id="pos_length_container" style="margin: auto;">

<div id="pos_length" style="margin: auto; max-width: 670px;border-style:solid;padding: 20px;border-color:gray;border-radius:15px;">
	<div>
		<b style="font-weight:bold">Generalization to a novel length:</b> Models are trained on inputs of length at most 4, then evaluated on inputs of the type they have seen before or on longer inputs.
	</div>
	<br>


	<div class="postable" style="display: inline-block; padding-right: 20px;">
	<div style="max-width:320px;">
		<b style="font-weight:bold">Predictions for inputs of length 4 or less (the models have seen inputs of these lengths, but not these particular inputs)</b>
	</div>

			<table class="hor-minimalist-a" style="max-width:320px;">
				<tr class="top">
					<th style="width:35;" class='cell'><div>Input</div></th>
					<th style="width:75;" class='cell'><div>Correct<br> output</div></th>
					<th style="width:75;" class='cell'><div>Meta-initialized<br>model's output</div></th>
					<th style="width:75;" class='cellcollapsible'><div class='cell'>Randomly-initialized<br>model's output</div></th>
				</tr>
				<tr>
					<td class='cell'><div>jkk</div></td>
					<td class='cell'><div>.ja.ka.ka.</div></td>
					<td class='cell'><div style='color: green'>.ja.ka.ka.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.ja.ka.ka.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>iji</div></td>
					<td class='cell'><div>.ji.ji.</div></td>
					<td class='cell'><div style='color: green'>.ji.ji.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.ji.ji.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>iEEE</div></td>
					<td class='cell'><div>.ji.jE.jE.jE.</div></td>
					<td class='cell'><div style='color: green'>.ji.jE.jE.jE.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.ji.jE.jE.jE.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>Oij</div></td>
					<td class='cell'><div>.jO.ji.ja.</div></td>
					<td class='cell'><div style='color: green'>.jO.ji.ja.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.jO.ji.ja.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>xaOO</div></td>
					<td class='cell'><div>.xa.jO.jO.</div></td>
					<td class='cell'><div style='color: green'>.xa.jO.jO.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.xa.jO.jO.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>axEk</div></td>
					<td class='cell'><div>.ja.xE.ka.</div></td>
					<td class='cell'><div style='color: green'>.ja.xE.ka.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.ja.xE.ka.</div></td>
				</tr>
			</table>
	</div>



	<div class="postable" style="display: inline-block;">
	<div style="max-width:320px;">
		<b style="font-weight:bold">Predictions for inputs of length 5 (models have not seen any inputs of this length)</b>
	</div>


			<table class="hor-minimalist-a" style="max-width:320px;">
				<tr class="top">
					<th style="width:35;" class='cell'><div>Input</div></th>
					<th style="width:75;" class='cell'><div>Correct<br> output</div></th>
					<th style="width:75;" class='cell'><div>Meta-initialized<br>model's output</div></th>
					<th style="width:75;" class='cellcollapsible'><div class='cell'>Randomly-initialized<br>model's output</div></th>
				</tr>
				<tr>
					<td class='cell'><div>jxaai</div></td>
					<td class='cell'><div>.ja.xa.ja.ji.</div></td>
					<td class='cell'><div style='color: green'>.ja.xa.ja.ji.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.ja.xa.ji.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>jjEjO</div></td>
					<td class='cell'><div>.ja.jE.jO.</div></td>
					<td class='cell'><div style='color: green'>.ja.jE.jO.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.ja.jE.jO.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>jOOja</div></td>
					<td class='cell'><div>.jO.jO.ja.</div></td>
					<td class='cell'><div style='color: green'>.jO.jO.ja.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.jO.jO.ja.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>jkkaa</div></td>
					<td class='cell'><div>.ja.ka.ka.ja.</div></td>
					<td class='cell'><div style='color: green'>.ja.ka.ka.ja.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.ja.ka.ja.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>Ejjaa</div></td>
					<td class='cell'><div>.jE.ja.ja.ja.</div></td>
					<td class='cell'><div style='color: green'>.jE.ja.ja.ja.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.jE.ja.ja.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>OEOja</div></td>
					<td class='cell'><div>.jO.jE.jO.ja.</div></td>
					<td class='cell'><div style='color: green'>.jO.jE.jO.ja.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.jO.jE.jO.</div></td>
				</tr>
			</table>

	</div>
<br><br>
<div>
<b style="font-weight:bold">Comments:</b> During meta-training, all languages featured inputs up to length 5. Thus, this experiment only requires generalization within the bounds seen during meta-learning. We also tested how models generalized from lengths at most 5 to length 6; in this case, the model initialized with meta-learning did not perform as well as it does in generalizing to length 5, suggesting that its generalization capabilities are restricted to the types of patterns seen during meta-learning.
</div>


</div>
</div>




<div id="pos_imp_container" style="margin: auto;">
<div id="pos_imp" style="margin: auto; max-width: 670px;border-style:solid;padding: 20px;border-color:gray;border-radius:15px;">
	<div>
		<b style="font-weight:bold">Implicational universal:</b> Models are trained on mappings of the form <em>vowel-consonant &rarr; vowel</em>, then evaluated on generalization to inputs of the form <em>consonant-vowel-consonant</em>. In the framework we use, any language that maps <em>vowel-consonant</em> to <em>vowel</em> will also map <em>consonant-vowel-consonant</em> to <em>consonant-vowel</em>.
	</div>
	<br>


	<div class="postable" style="display:inline-block; padding-right: 20px;">
	<div style="max-width:320px;">
		<b style="font-weight:bold">Predictions for inputs of the form vowel-consonant (models have seen this type of input, but not these particular examples)</b>
	</div>


			<table class="hor-minimalist-a" style="max-width:320px;">
				<tr class="top">
					<th style="width:35;" class='cell'><div>Input</div></th>
					<th style="width:50;" class='cell'><div>Correct<br> output</div></th>
					<th style="width:75;" class='cell'><div>Meta-initialized<br>model's output</div></th>
					<th style="width:75;" class='cellcollapsible'><div class='cell'>Randomly-initialized<br>model's output</div></th>
				</tr>
				<tr>
					<td class='cell'><div>is</div></td>
					<td class='cell'><div>.i.</div></td>
					<td class='cell'><div style='color: green'>.i.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.i.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>Um</div></td>
					<td class='cell'><div>.U.</div></td>
					<td class='cell'><div style='color: green'>.U.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.U.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>iq</div></td>
					<td class='cell'><div>.i.</div></td>
					<td class='cell'><div style='color: green'>.i.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.i.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>or</div></td>
					<td class='cell'><div>.o.</div></td>
					<td class='cell'><div style='color: green'>.o.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.o.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>Er</div></td>
					<td class='cell'><div>.E.</div></td>
					<td class='cell'><div style='color: green'>.E.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.E.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>Ex</div></td>
					<td class='cell'><div>.E.</div></td>
					<td class='cell'><div style='color: green'>.E.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.E.</div></td>
				</tr>
			</table>
	</div>



	<div class="postable" style="display: inline-block;">
	<div style="max-width:320px;">
		<b style="font-weight:bold">Predictions for inputs of the form consonant-vowel-consonant (models have not seen this type of input during training)</b>
	</div>



			<table class="hor-minimalist-a" style="max-width:320px;">
				<tr class="top">
					<th style="width:35;" class='cell'><div>Input</div></th>
					<th style="width:50;" class='cell'><div>Correct<br> output</div></th>
					<th style="width:75;" class='cell'><div>Meta-initialized<br>model's output</div></th>
					<th style="width:75;" class='cellcollapsible'><div class='cell'>Randomly-initialized<br>model's output</div></th>
				</tr>
				<tr>
					<td class='cell'><div>fir</div></td>
					<td class='cell'><div>.fi.</div></td>
					<td class='cell'><div style='color: green'>.fi.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.o.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>bit</div></td>
					<td class='cell'><div>.bi.</div></td>
					<td class='cell'><div style='color: green'>.bi.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.i.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>bac</div></td>
					<td class='cell'><div>.ba.</div></td>
					<td class='cell'><div style='color: green'>.ba.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.e.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>hoh</div></td>
					<td class='cell'><div>.ho.</div></td>
					<td class='cell'><div style='color: green'>.ho.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.o.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>vAk</div></td>
					<td class='cell'><div>.vA.</div></td>
					<td class='cell'><div style='color: green'>.vA.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.A.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>cOx</div></td>
					<td class='cell'><div>.cO.</div></td>
					<td class='cell'><div style='color: green'>.cO.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.O.</div></td>
				</tr>
			</table>

	</div>

<br><br>
<div>
<b style="font-weight:bold">Comments:</b> The randomly-initialized model appears to have learned a constraint on the form of the output, namely that it must consist of a single vowel. This constraint holds for the models' training set but not for the generalization that we test, giving this model poor generalization performance.
</div>



</div>
</div>












<div id="pos_new_container" style="margin: auto;">
<div id="pos_new" style="margin: auto; max-width: 670px;border-style:solid;padding: 20px;border-color:gray;border-radius:15px;">
	<div>
		<b style="font-weight:bold">Generalization a novel symbols:</b> Models are trained on inputs containing only the symbols <em>E, A, j, x, p,</em> and <em>c</em>, then are tested on generalization to inputs containing novel symbols.
	</div>
	<br>


	<div class="postable" style="display: inline-block; padding-right: 20px;">
	<div style="max-width:320px;">
		<b style="font-weight:bold">Predictions for inputs composed of familiar sounds</b>
	</div>


			<table class="hor-minimalist-a" style="max-width:320px;">
				<tr class="top">
					<th style="width:35;" class='cell'><div>Input</div></th>
					<th style="width:75;" class='cell'><div>Correct<br> output</div></th>
					<th style="width:75;" class='cell'><div>Meta-initialized<br>model's output</div></th>
					<th style="width:75;" class='cellcollapsible'><div class='cell'>Randomly-initialized<br>model's output</div></th>
				</tr>
				<tr>
					<td class='cell'><div>Ejpjj</div></td>
					<td class='cell'><div>.E.jEp.jEj.</div></td>
					<td class='cell'><div style='color: green'>.E.jEp.jEj.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.E.jEp.jEj.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>AjjjE</div></td>
					<td class='cell'><div>.A.jEj.jE.</div></td>
					<td class='cell'><div style='color: green'>.A.jEj.jE.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.A.jEj.jE.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>jxAxp</div></td>
					<td class='cell'><div>.jE.xA.xEp.</div></td>
					<td class='cell'><div style='color: green'>.jE.xA.xEp.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.jE.xA.xEp.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>EAjEA</div></td>
					<td class='cell'><div>.E.A.jE.A.</div></td>
					<td class='cell'><div style='color: green'>.E.A.jE.A.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.E.A.jE.A.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>Ej</div></td>
					<td class='cell'><div>.Ej.</div></td>
					<td class='cell'><div style='color: green'>.Ej.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.Ej.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>pEA</div></td>
					<td class='cell'><div>.pE.A.</div></td>
					<td class='cell'><div style='color: green'>.pE.A.</div></td>
					<td class='cellcollapsible'><div style='color: green'>.pE.A.</div></td>
				</tr>
			</table>

	</div>



	<div class="postable" style="display: inline-block;">
	<div style="max-width:320px;">
		<b style="font-weight:bold">Predictions for inputs composed of unfamiliar sounds</b>
	</div>


			<table class="hor-minimalist-a" style="max-width:320px;">
				<tr class="top">
					<th style="width:35;" class='cell'><div>Input</div></th>
					<th style="width:75;" class='cell'><div>Correct<br> output</div></th>
					<th style="width:75;" class='cell'><div>Meta-initialized<br>model's output</div></th>
					<th style="width:75;" class='cellcollapsible'><div class='cell'>Randomly-initialized<br>model's output</div></th>
				</tr>
				<tr>
					<td class='cell'><div>eXr</div></td>
					<td class='cell'><div>.e.XEr.</div></td>
					<td class='cell'><div style='color: green'>.e.XEr.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.A.E.XE.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>Oenw</div></td>
					<td class='cell'><div>.O.e.nEw.</div></td>
					<td class='cell'><div style='color: green'>.O.e.nEw.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.A.A.cEc.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>UUAfi</div></td>
					<td class='cell'><div>.U.U.A.fi.</div></td>
					<td class='cell'><div style='color: green'>.U.U.A.fi.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.cE.cA.Ej.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>kdAri</div></td>
					<td class='cell'><div>.kE.dA.ri.</div></td>
					<td class='cell'><div style='color: green'>.kE.dA.ri.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.cE.Aj.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>eh</div></td>
					<td class='cell'><div>.eh.</div></td>
					<td class='cell'><div style='color: green'>.eh.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.A.A.</div></td>
				</tr>
				<tr>
					<td class='cell'><div>tnsvU</div></td>
					<td class='cell'><div>.tE.nEs.vU.</div></td>
					<td class='cell'><div style='color: green'>.tE.nEs.vU.</div></td>
					<td class='cellcollapsible'><div style='color: red'>.jE.xEj.jEc.</div></td>
				</tr>
			</table>
	</div>

<br><br>
<div>
<b style="font-weight:bold">Comments:</b> The randomly-initialized model has no hope of success in this case, since it has no way to know whether each novel symbol is a consonant or vowel, which is critical information for processing each input. However, the meta-initialized model could have learned this information during its meta-training phase, and its successful generalization shows that it has indeed done so.
</div>


</div>
</div>

<br>

<p>Across all three cases, the meta-initialized model generalizes well while the randomly-initialized model generalizes poorly. These results indicate that meta-learning has successfully imparted a bias for the length-invariance of syllable patterns, a bias for assuming two universal classes of symbols (namely, consonants and vowels), and a bias for associating certain mappings with certain other mappings (a.k.a. implicational universals).</p>

<p>Linguistic universals are typically divided into two categories: absolute universals, which are properties that all languages possess, and implicational universals, which are cases where the presence of one property in a language implies the presence of another property. The previous section showed that meta-learning had instilled some absolute universals in the model, while this section shows that it has also instilled some implicational universals. Thus, meta-learning can impart both of the major categories of linguistic universals.</p> 


<p>See the paper for more discussion of these experiments and for investigation of three other inductive biases using an alternate technique, namely ease of learning (that is, which types of languages are easiest for a model to learn?)</p>



<h2>How does it work?</h2>

	<p>Our method can be summarized as follows:</p>

	<ol>
		<li>Determine the set of linguistic inductive biases that you wish to impart to a model.</li>
		<li>Define a space of languages encoding those inductive biases.</li>
		<li>Have a model meta-learn from this space of languages; this process is intended to give the model an initial parameter setting from which it can easily learn any language in the space of languages you have defined.</li>
		<li>Analyze the model to verify that meta-learning has given it the intended inductive biases.</li>
	</ol>

	<p>The core component of our method is meta-learning; the particular type of meta-learning that we use is <a href="http://proceedings.mlr.press/v70/finn17a/finn17a.pdf">MAML</a>. In MAML, a model is exposed to a variety of tasks, each of which comes with a limited amount of data. After exposure to each task, the model's weights are adjusted so that, if it were taught the same task again, it would perform better. As MAML proceeds, the model converges to an initial state from which it can readily learn any task in the distribution of tasks it has been shown. The demo below gives an example of MAML.</p>



	<div style="margin: auto; max-width: 550px;" class="demowrapper">
	<div style="display:inline-block; margin: auto">
	<div style="margin: auto; width: 150px;"><b style="font-weight:bold">Model parameters</b></div>
	<canvas id="myCanvas" style="border-style: solid;" height=200 width=200px></canvas>
	</div>

	<div style="display:inline-block; margin: auto">
    <div style="margin: auto; width: 150px;"><b style="font-weight:bold">Inputs and outpus</b></div>
	<canvas id="myCanvas2" style="border-style: solid;" height=200 width=200px></canvas>
	</div>

	<div width=100 style="display: inline-block; width: 110px; vertical-align:top" id="mamltextcontainer">

		<br>
		<br>

		<div style="height: 60px; padding-left: 10px;">
		<div class="slidecontainer" style="width: 10px;">
  			<input style="width: 100px" type="range" min="1" max="100" value="50" class="slider" id="myRange">
		</div>

		<div>Adjust speed</div>

		</div>
		<button type="button" class="startstopbtn" id="mamlstart" onclick="myLoop();" style="display: inline-block; vertical-align:top;">Start demo</button>

		
		<button type="button" class="startstopbtn" onclick="resetDemo();" style="display: inline-block; vertical-align:top;">Reset demo</button>

	</div>

	<div id="mamltext" style="padding-left: 90px;"><br></div>

	</div>

<div style="padding-top: 15px; padding-bottom: 40px; padding-left: 50px; padding-right: 50px; font-size: 13px;">
    <em>Demonstration of meta-learning using MAML. The model is a simple linear function with 2 parameters (a slope and an intercept): the green star in the left plot shows the parameters, and the solid green line in the right plot shows the function defined by these parameters. This model is exposed to many target tasks, each a linear function defined by a purple square in the left plot. All of these purple squares are drawn from the perimeter of the circle, providing some similarity across tasks that the meta-learning process can exploit. For each target task, a copy of the model is trained on 10 examples (the purple points in the right plot), yielding the parameters at the orange circle in the left plot and the function shown by the orange dotted line in the right plot. Based on how close this copy is to the target, the model's initialization is adjusted. After many iterations, the model's initialization reaches a point from which the model can learn any target task&mdash;somewhere in the middle of the circle in the left plot.</em>
</div>

	<p>If meta-learning is successful, the model's initialization will encode some set of inductive biases that are useful for learning the space of tasks that the model is being shown. In the demo, the initialization that the model converges to encodes a bias for the slope to be close to -3 and for the intercept to be close to -2.</p>

	<p>In this simple example, it would have been easy to set the model's parameters by hand in a way that encoded this bias. However, such hand-coding of biases is not practical with standard neural networks, which typically have far more parameters (often tens of millions of parameters, or even <a href="https://arxiv.org/pdf/2005.14165.pdf">175 billion parameters</a>) which interact with each other in difficult-to-interpret ways. In such cases where manual parameter setting is impractical, meta-learning can automatically discover parameter settings that encode the desired biases.</p>

	<p>In our application of meta-learning, each “task” is a language, and the goal is to find a set of initial parameter values that allow the model to quickly learn any language. We hypothesize that, if we carefully construct the space of languages used during meta-learning to encode a desired set of inductive biases, we can impart these inductive biases in order to study how they affect generalization behavior.</p>

<h2>Conclusions and future directions</h2>

<p>We have shown how meta-learning can impart inductive biases specified by the modeler. While the meta-learned biases are not as transparent as those encoded in probabilistic symbolic models, analysis of the model's learning behavior can be used to evaluate whether meta-learning has produced the desired biases, as we have shown. Our case study demonstrates that linguistic inductive biases that have previously been framed in symbolic terms can be reformulated in the context of neural networks, facilitating cognitive modeling that combines the power of neural networks with the controlled inductive biases of symbolic methods.</p>

<p>In future work, we plan to use this approach to study open questions in cognitive science. For example, by creating a model that has a particular bias which has been argued to be important for human cognition, we can empirically test whether the bias has the explanatory power that it has been argued to have. Alternately, while our case study involved giving a model certain pre-selected biases, this approach could instead be applied to naturally-occurring linguistic data to lend insight into the inductive biases that shaped this data. Finally, this approach might have applications in Artificial Intelligence: By giving targeted, cognitively-motivated learning biases to models, we may be able to decrease the gap between the learning capabilities of AI models and humans.</p>

<p><em>See <a href="https://arxiv.org/pdf/2006.16324.pdf">the full paper</a> for more details. If you have questions or comments, email <a href="mailto:tom.mccoy@jhu.edu">tom.mccoy@jhu.edu</a>.</em></p>

<p style="text-align: center">*****</p>

<p><em>Some fine print about this website: The demos differ from the experiments in the paper in a few ways designed to decrease the computation load for the website. First, the models on the website are GRUs, while in the paper we used LSTMs. Second, training in the demos uses a batch size of 1 with stochastic gradient descent, while the paper uses a batch size of 10 with the Adam optimizer. Thus, the performance of the demo models is not guaranteed to be the same as the performance of the models used in the paper. Finally, on this page, we have excluded any examples containing lowercase L or capital i, as the similarity of these letters sometimes makes examples hard to read, but both letters were available in the experiments in the paper.</em></p>

</div>




</section>
</div> <!--End of content wrapper-->

<script src="metaug_js/maml_weights_js_variables.js"></script>
<script src="metaug_js/charinddicts.js"></script>
<script src="metaug_js/tf_weights.js"></script>
<script src="metaug_js/ioc.js"></script>
<script>


function toggle_pos(pos_type) {
	document.getElementById("pos_length_container").style.display = "none";
	document.getElementById("pos_imp_container").style.display = "none";
	document.getElementById("pos_new_container").style.display = "none";
	
	document.getElementById("lengthbtn").style.backgroundColor = "white";
    document.getElementById("lengthbtn").style.color = "black";
	document.getElementById("lengthbtn").style.borderColor = "black";

	document.getElementById("impbtn").style.backgroundColor = "white";
    document.getElementById("impbtn").style.color = "black";
	document.getElementById("impbtn").style.borderColor = "black";

	document.getElementById("newbtn").style.backgroundColor = "white";
    document.getElementById("newbtn").style.color = "black";
	document.getElementById("newbtn").style.borderColor = "black";

	document.getElementById("pos_" + pos_type + "_container").style.display = "block";

	document.getElementById(pos_type + "btn").style.backgroundColor = "gray";
	document.getElementById(pos_type + "btn").style.borderColor = "gray";
	document.getElementById(pos_type + "btn").style.color = "white";

}

toggle_pos("length");


const key2ranking = {
	"(0, 1, 2, 3)" : "Onset, NoCoda, NoDeletion &#187; NoInsertion",
	"(0, 1, 3, 2)" : "Onset, NoCoda, NoInsertion &#187; NoDeletion",
	"(0, 3, 2, 1)" : "Onset, NoInsertion &#187; NoDeletion &#187; NoCoda",
	"(1, 3, 2, 0)" : "NoCoda, NoInsertion &#187;  NoDeletion &#187; Onset",
	"(0, 2, 3, 1)" : "Onset, NoDeletion &#187; NoInsertion &#187; NoCoda",
	"(1, 2, 3, 0)" : "NoCoda, NoDeletion &#187; NoInsertion &#187; Onset",
	"(3, 2, 0, 1)" : "NoInsertion &#187; NoDeletion &#187; Onset, NoCoda",
	"(2, 3, 0, 1)" : "NoDeletion &#187; NoInsertion &#187; Onset, NoCoda"
}



function change_thousands(to_show, ranking) {
	for(th_index = 1; th_index < 9; th_index++) {
		document.getElementById("thousands" + th_index).style.display = "none";
	}

	document.getElementById("thousands" + to_show).style.display = "block";

	document.getElementById("rankbtn2").innerHTML = key2ranking[ranking];

}

change_thousands(4, '(0, 1, 2, 3)');


var showing_adv = true;
function toggleshowadv() {
	if (showing_adv) {
		document.getElementById("advancedsettings").style.display = "none";
		showing_adv = false;
		document.getElementById("advbtntxt").innerHTML = "Show advanced settings";
		document.getElementById("patterndiv").style.borderBottom = "1pt none black";
	} else {
		document.getElementById("advancedsettings").style.display = "block";
		showing_adv = true;
		document.getElementById("advbtntxt").innerHTML = "Hide advanced settings";
		document.getElementById("patterndiv").style.borderBottom = "1pt solid black";
	}
} 

toggleshowadv();


this_counter = 0;

manual_ranking = "";
manual_vowel_inventory = [];
manual_consonant_inventory = [];
all_vowels = ["a", "e", "i", "o", "u", "biga", "bige", "bigo", "bigu"];
all_consonants = ["b", "c", "d", "f", "g", "h", "j", "k", "m", "n", "p", "q", "r", "s", "t", "v", "w", "x", "z"];


function ranktoggle(ranking) {
	manual_ranking = ranking;
	document.getElementById("rankbtn").innerHTML = key2ranking[ranking];

	document.getElementById("langdesc").innerHTML = key2description[ranking].replace("CONS", manual_ep_cons).replace("VOW", manual_ep_vow);
	renew_language();	
}

function vtoggle(vow) {
	if (!manual_vowel_inventory.includes(vow)) {
		manual_vowel_inventory.push(vow);
		document.getElementById("btn" + vowel_dict[vow]).style.backgroundColor = "blue";
		document.getElementById("btn" + vowel_dict[vow]).style.color = "white";
	} else {

		split_point = manual_vowel_inventory.indexOf(vow);
		manual_vowel_inventory = manual_vowel_inventory.slice(0,split_point).concat(manual_vowel_inventory.slice(split_point + 1));
		document.getElementById("btn" + vowel_dict[vow]).style.backgroundColor = "white";
		document.getElementById("btn" + vowel_dict[vow]).style.color = "black";
	}




	for (v_index = 0; v_index < all_vowels.length; v_index++) {
		vow = all_vowels[v_index];
		document.getElementById("btnep" + vowel_dict[vow]).style.backgroundColor = "white";
		document.getElementById("btnep" + vowel_dict[vow]).style.color =
 "black";
		document.getElementById("btnep" + vowel_dict[vow]).style.display = "none";
	}

	for (vm_index = 0; vm_index < manual_vowel_inventory.length; vm_index++) {
		vow = vowel_dict[manual_vowel_inventory[vm_index]];
		document.getElementById("btnep" + vowel_dict[vow]).style.display = "inline";
	}

	if (!manual_vowel_inventory.includes(manual_ep_vow)) {
		manual_ep_vow = choice(manual_vowel_inventory);
	}

	document.getElementById("btnep" + vowel_dict[manual_ep_vow]).style.backgroundColor = "blue";
	document.getElementById("btnep" + vowel_dict[manual_ep_vow]).style.color =
 "white";


	renew_language();


}

function ctoggle(cons) {
	if (!manual_consonant_inventory.includes(cons)) {
		manual_consonant_inventory.push(cons);
		document.getElementById("btn" + cons).style.backgroundColor = "blue";
		document.getElementById("btn" + cons).style.color = "white";
	} else {

		split_point = manual_consonant_inventory.indexOf(cons);
		manual_consonant_inventory = manual_consonant_inventory.slice(0,split_point).concat(manual_consonant_inventory.slice(split_point + 1));
		document.getElementById("btn" + cons).style.backgroundColor = "white";
		document.getElementById("btn" + cons).style.color = "black";
	}




	for (c_index = 0; c_index < all_consonants.length; c_index++) {
		cons = all_consonants[c_index];
		document.getElementById("btnep" + cons).style.backgroundColor = "white";
		document.getElementById("btnep" + cons).style.color = "black";
		document.getElementById("btnep" + cons).style.display = "none";
	}

	for (cm_index = 0; cm_index < manual_consonant_inventory.length; cm_index++) {
		cons = manual_consonant_inventory[cm_index];
		document.getElementById("btnep" + cons).style.display = "inline";
	}

	if (!manual_consonant_inventory.includes(manual_ep_cons)) {
		manual_ep_cons = choice(manual_consonant_inventory);
	}

	document.getElementById("btnep" + manual_ep_cons).style.backgroundColor = "blue";
	document.getElementById("btnep" + manual_ep_cons).style.color =
 "white";


	renew_language();


}

function ceptoggle(cons) {

	for (cn = 0; cn < manual_consonant_inventory.length; cn++) {
		first_c = manual_consonant_inventory[cn];
		document.getElementById("btnep" + first_c).style.color = "black";
		document.getElementById("btnep" + first_c).style.backgroundColor = "white";
	}
	
	document.getElementById("btnep" + cons).style.color = "white";
	document.getElementById("btnep" + cons).style.backgroundColor = "blue";

	manual_ep_cons = cons;

	renew_language();
}

function veptoggle(vow) {

	for (vn = 0; vn < vowels.length; vn++) {
		first_v = vowel_dict[vowels[vn]];
		document.getElementById("btnep" + first_v).style.color = "black";
		document.getElementById("btnep" + first_v).style.backgroundColor = "white";
	}
	document.getElementById("btnep" + vowel_dict[vow]).style.color = "white";
	document.getElementById("btnep" + vowel_dict[vow]).style.backgroundColor = "blue";

	manual_ep_vow = vow;

	renew_language();
}



vowel_dict = {
	"a" : "a",
	"e" : "e",
	"i" : "i",
	"o" : "o",
	"u" : "u",
	"A" : "biga",
	"E" : "bige",
	"O" : "bigo",
	"U" : "bigu",
	"biga" : "biga",
	"bige" : "bige",
	"bigo" : "bigo",
	"bigu" : "bigu"	
}



function is_cvcv(x) {
	if (x == "CVCV") {
		console.log(x);
		return true;
	} else {
		return false;
	}
}


function is_cv(x) {
	if (x == "CV") {
		console.log(x + "IS HERE");
		return true;
	} else {
		return false;
	}
}


function random_language(full_random, abstract_input_filter_test) {

	new_lang = make_task(choice(rankings), all_input_outputs, abstract_input_filter_test, n_train=200, n_dev=0, n_test=6);
	
	if (full_random) {
		training_set = new_lang[0];
		training_set.push(["fake", "fake"]);
		test_set = new_lang[2];
	} else {
		results = manual_train_set();
		if (!results[0]) {
			return false;
		} else {
			training_set = results[1];
			test_set = results[2];
		}
	}


	dev_set = new_lang[1];
	new_vinv = new_lang[3];
	new_cinv = new_lang[4];

	test_set_firsts = [];
	for (tsf = 0; tsf<test_set.length; tsf++) {
    	test_set_firsts.push(test_set[tsf][0]);
	}

	manual_ranking = new_lang[5];
	manual_vowel_inventory = new_vinv;
	manual_consonant_inventory = new_cinv;
	manual_ep_vow = new_vinv[0];
	manual_ep_cons = new_cinv[0];



	for (spqr = 0; spqr < test_set.length; spqr++) {
		document.getElementById("inb" + (spqr + 1)).innerHTML = nullify(test_set[spqr][0]);
		document.getElementById("corrb" + (spqr + 1)).innerHTML = nullify(test_set[spqr][1]);
	}
	for (spqr = test_set.length; spqr < 6; spqr++) {
		document.getElementById("inb" + (spqr + 1)).innerHTML = "-";
		document.getElementById("corrb" + (spqr + 1)).innerHTML = "-";
		document.getElementById("metaoutb" + (spqr + 1)).innerHTML = "-";
		document.getElementById("randomoutb" + (spqr + 1)).innerHTML = "-";
	}


	for (v_index = 0; v_index < all_vowels.length; v_index++) {
		vow = all_vowels[v_index];
		document.getElementById("btn" + vow).style.backgroundColor = "white";
		document.getElementById("btn" + vow).style.color = "black";
		document.getElementById("btnep" + vow).style.backgroundColor = "white";
		document.getElementById("btnep" + vow).style.color = "black";
		document.getElementById("btnep" + vow).style.display = "none";
	}

	for (vm_index = 0; vm_index < manual_vowel_inventory.length; vm_index++) {
		vow = vowel_dict[manual_vowel_inventory[vm_index]];
		document.getElementById("btn" + vow).style.backgroundColor = "blue";
		document.getElementById("btn" + vow).style.color = "white";
		document.getElementById("btnep" + vow).style.display = "inline";
	}
	document.getElementById("btnep" + vowel_dict[manual_ep_vow]).style.backgroundColor = "blue";
	document.getElementById("btnep" + vowel_dict[manual_ep_vow]).style.color =
 "white";


	for (c_index = 0; c_index < all_consonants.length; c_index++) {
		cons = all_consonants[c_index];
		document.getElementById("btn" + cons).style.backgroundColor = "white";
		document.getElementById("btn" + cons).style.color = "black";
		document.getElementById("btnep" + cons).style.backgroundColor = "white";
        document.getElementById("btnep" + cons).style.color = "black";
		document.getElementById("btnep" + cons).style.display = "none";
	}

	for (cm_index = 0; cm_index < manual_consonant_inventory.length; cm_index++) {
		cons = manual_consonant_inventory[cm_index];
		document.getElementById("btn" + cons).style.backgroundColor = "blue";
		document.getElementById("btn" + cons).style.color = "white";
		document.getElementById("btnep" + cons).style.display = "inline";
	
	}

	document.getElementById("btnep" + manual_ep_cons).style.backgroundColor = "blue";
	document.getElementById("btnep" + manual_ep_cons).style.color = "white";


	reset_weights();
	
	  preds = tf.tidy(() => seq2seq(test_set_firsts)[0]);
	  for (lmnop = 0; lmnop < test_set.length; lmnop++) {
			pred = toz(preds[lmnop])
			if (pred == test_set[lmnop][1]) {
				font_color = "green";
			} else {
				font_color = "red";
			}
			document.getElementById("metaoutb" + (lmnop + 1)).innerHTML = "<span style='color: " + font_color + ";'>" + nullify(pred) + "</span>";
	  }


	  preds = tf.tidy(() => seq2seqb(test_set_firsts)[0]);
	  for (lmnop = 0; lmnop < test_set.length; lmnop++) {
			pred = toz(preds[lmnop]);
			if (pred == test_set[lmnop][1]) {
                font_color = "green";
            } else {
                font_color = "red";
            }


			document.getElementById("randomoutb" + (lmnop + 1)).innerHTML = "<span style='color: " + font_color + ";'>" + nullify(pred) + "</span>";
	  }


	document.getElementById("rankbtn").innerHTML = key2ranking[manual_ranking];
	document.getElementById("langdesc").innerHTML = key2description[manual_ranking].replace("CONS", manual_ep_cons).replace("VOW", manual_ep_vow);

	this_counter = 0;
	document.getElementById("traincount").innerHTML = this_counter;
	document.getElementById("traincount2").innerHTML = this_counter;
	if (this_counter == 1) {
		document.getElementById("exsing").innerHTML = "example";
	} else {
		document.getElementById("exsing").innerHTML = "examples";
	}

	seen_training = "";
    document.getElementById("trainingexamplelist").innerHTML = seen_training;
	document.getElementById("trainingexamplelist").scrollTop = document.getElementById("trainingexamplelist").scrollHeight;

	document.getElementById("oneexamplebtn").disabled = false;

	fitfitfitfirst(seq2seq, 'meta', add_train=true);
	fitfitfitfirst(seq2seqb, 'random');

}


function renew_language() {
	ind_ep_vow = manual_vowel_inventory.indexOf(manual_ep_vow);

	manual_ep_vow_list = [manual_ep_vow];
	manual_vowel_inventory = manual_ep_vow_list.concat(manual_vowel_inventory.slice(0,ind_ep_vow).concat(manual_vowel_inventory.slice(ind_ep_vow + 1)));

	ind_ep_cons = manual_consonant_inventory.indexOf(manual_ep_cons);

	manual_ep_cons_list = [manual_ep_cons];
	manual_consonant_inventory = manual_ep_cons_list.concat(manual_consonant_inventory.slice(0,ind_ep_cons).concat(manual_consonant_inventory.slice(ind_ep_cons + 1)));



	new_lang = make_task(manual_ranking, all_input_outputs, trf, n_train=200, n_dev=1, n_test=6, v_list=manual_vowel_inventory, c_list=manual_consonant_inventory);

	training_set = new_lang[0];
	dev_set = new_lang[1];
	test_set = new_lang[2];
	test_set_firsts = [];
	for (tsf = 0; tsf<test_set.length; tsf++) {
		test_set_firsts.push(test_set[tsf][0]);
	}
	for (spqr = 0; spqr < test_set.length; spqr++) {
		document.getElementById("inb" + (spqr + 1)).innerHTML = nullify(test_set[spqr][0]);
		document.getElementById("corrb" + (spqr + 1)).innerHTML = nullify(test_set[spqr][1]);
	}
	for (spqr = test_set.length; spqr < 6; spqr++) {
		document.getElementById("inb" + (spqr + 1)).innerHTML = "-";
		document.getElementById("corrb" + (spqr + 1)).innerHTML = "-";
		document.getElementById("metaoutb" + (spqr + 1)).innerHTML = "-";
		document.getElementById("randomoutb" + (spqr + 1)).innerHTML = "-";
	}



	for (v_index = 0; v_index < all_vowels.length; v_index++) {
		vow = all_vowels[v_index];
		document.getElementById("btn" + vow).style.backgroundColor = "white";
		document.getElementById("btn" + vow).style.color = "black";
		document.getElementById("btnep" + vow).style.display = "none";
	}

	for (vm_index = 0; vm_index < manual_vowel_inventory.length; vm_index++) {
		vow = vowel_dict[manual_vowel_inventory[vm_index]];
		document.getElementById("btn" + vow).style.backgroundColor = "blue";
		document.getElementById("btn" + vow).style.color = "white";
		document.getElementById("btnep" + vow).style.display = "inline";
	}
	document.getElementById("btnep" + vowel_dict[manual_ep_vow]).style.backgroundColor = "blue";
	document.getElementById("btnep" + vowel_dict[manual_ep_vow]).style.color =
 "white";


	for (c_index = 0; c_index < all_consonants.length; c_index++) {
		cons = all_consonants[c_index];
		document.getElementById("btn" + cons).style.backgroundColor = "white";
		document.getElementById("btn" + cons).style.color = "black";
		document.getElementById("btnep" + cons).style.display = "none";
	}

	for (cm_index = 0; cm_index < manual_consonant_inventory.length; cm_index++) {
		cons = manual_consonant_inventory[cm_index];
		document.getElementById("btn" + cons).style.backgroundColor = "blue";
		document.getElementById("btn" + cons).style.color = "white";
		document.getElementById("btnep" + cons).style.display = "inline";
	
	}

	document.getElementById("btnep" + manual_ep_cons).style.backgroundColor = "blue";
	document.getElementById("btnep" + manual_ep_cons).style.color = "white";


	reset_weights();
	
	  preds = tf.tidy(() => seq2seq(test_set_firsts)[0]);
	  for (lmnop = 0; lmnop < test_set.length; lmnop++) {
			pred = toz(preds[lmnop])
			if (pred == test_set[lmnop][1]) {
				font_color = "green";
			} else {
				font_color = "red";
			}
			document.getElementById("metaoutb" + (lmnop + 1)).innerHTML = "<span style='color: " + font_color + ";'>" + nullify(pred) + "</span>";
	  }


	  preds = tf.tidy(() => seq2seqb(test_set_firsts)[0]);
	  for (lmnop = 0; lmnop < test_set.length; lmnop++) {
			pred = toz(preds[lmnop]);
			if (pred == test_set[lmnop][1]) {
                font_color = "green";
            } else {
                font_color = "red";
            }


			document.getElementById("randomoutb" + (lmnop + 1)).innerHTML = "<span style='color: " + font_color + ";'>" + nullify(pred) + "</span>";
	  }


	document.getElementById("rankbtn").innerHTML = key2ranking[manual_ranking];
	document.getElementById("langdesc").innerHTML = key2description[manual_ranking].replace("CONS", manual_ep_cons).replace("VOW", manual_ep_vow);

	this_counter = 0;
	document.getElementById("traincount").innerHTML = this_counter;
	document.getElementById("traincount2").innerHTML = this_counter;
	if (this_counter == 1) {
		document.getElementById("exsing").innerHTML = "example";
	} else {
		document.getElementById("exsing").innerHTML = "examples";
	}


	seen_training = "";
    document.getElementById("trainingexamplelist").innerHTML = seen_training;
	document.getElementById("trainingexamplelist").scrollTop = document.getElementById("trainingexamplelist").scrollHeight;

	fitfitfitfirst(seq2seq, 'meta', add_train=true);
    fitfitfitfirst(seq2seqb, 'random');
}


function toz(inp) {
	if (inp.includes("Z")) {
		inp = inp.slice(0, inp.indexOf("Z"));
	}

	return inp;
}

function nullify(inp) {

	//if (inp.includes("Z")) {
	//	inp = inp.slice(0, inp.indexOf("Z"));
	//}

	if (inp === "") {
		return "&lt;empty&gt;";
	} else {
		return inp;
	}
}

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    let j = Math.floor(Math.random() * (i + 1)); // random index from 0 to i

    [array[i], array[j]] = [array[j], array[i]];
  }
}

function choice(array) {
	return array[Math.floor(Math.random() * array.length)];
}



function trf(x) {
	return true;
}

vowels = ['a', 'e', 'i', 'o', 'u', 'A', 'E', 'O', 'U'];
consonants = ['b', 'c', 'd', 'f', 'g', 'h', 'j', 'k', 'm', 'n', 'p', 'q', 'r', 's', 't', 'v', 'w', 'x', 'z'];

function phoneme_inventory(nc=null, nv=null) {
	if (nc == null) {
		nc = Math.floor(Math.random() * 3) + 2;
	}

	if (nv == null) {
		nv = Math.floor(Math.random() * 3) + 2;
	}

	shuffle(vowels);
	shuffle(consonants);

	v_inv = vowels.slice(0,nv);
	c_inv = consonants.slice(0,nc);	

	return [v_inv, c_inv];

}


function output_string(inp, outp, v_list, c_list, steps=None, change_one=False, change_all=False) {
	outp_no_periods = outp.replace(/\./g, "");
	inp_phonemes = [];
	for (i = 0; i < inp.length; i++) {
		thischar = inp[i];
		if (thischar == "C") {
			inp_phonemes.push(choice(c_list));
		} else {
			inp_phonemes.push(choice(v_list));
		}
	}

	inp_word = inp_phonemes.join("");
	if (change_one) {
		inp_word = replace_one(inp_word, v_list, c_list);
	} else if (change_all) {
		inp_word = replace_all(inp_word, v_list, c_list);
	}

	inp_phonemes = inp_word;

	outp_phonemes = [];
	indi = 0;
	indo = 0;

	for (j = 0; j < steps.length; j++) {
		stp = steps[j];
		if (stp == "next") {
			outp_phonemes.push(inp_phonemes[indi]);
			indi++;
			indo++;
		}
		if (stp == "del") {
			indi++;
		}
		if (stp == "ins") {
			if (outp_no_periods[indo] == "C") {
				outp_phonemes.push(c_list[0]);
			} else {
				outp_phonemes.push(v_list[0]);
			}
			indo += 1;
		}

	}

	outp_alignment = [];
	ind_al = 0;

	for (k = 0; k < outp.length; k++) {
		thischar = outp[k];
		if (thischar == ".") {
			outp_alignment.push(thischar);
		} else {
			outp_alignment.push(ind_al);
			ind_al++;
		}
	}

	outp_chars = [];
	for (q = 0; q < outp_alignment.length; q++) {
		elt = outp_alignment[q];
		if (elt == ".") {
			outp_chars.push(".");
		} else {
			outp_chars.push(outp_phonemes[elt]);
		}
	}

	outp_word = outp_chars.join("");
	return [inp_word, outp_word];

}
	




function make_task(ranking, all_input_outputs, abstract_input_filter_test, n_train=10, n_dev=10, n_test=10, v_list=null, c_list=null, periods=true, input_filter_dev=trf, output_filter_dev=trf, input_filter_test=trf, output_filter_test=trf, input_filter_train=trf, output_filter_train=trf, abstract_input_filter_dev=trf, abstract_output_filter_dev=trf, abstract_input_filter_testX=trf, abstract_output_filter_test=trf, abstract_input_filter_train=trf, abstract_output_filter_train=trf, replace_one_dev=false, replace_one_test=false, replace_one_train=false, replace_all_dev=false, replace_all_test=false, replace_all_train=false, artificial_io_list=null) {
	if (all_input_outputs != null) {
		io_list = all_input_outputs[ranking].slice();
	} else {
		io_list = artificial_io_list;
	}

	shuffle(io_list);

	if (v_list == null || c_list == null) {
		inv = phoneme_inventory();
		v_list = inv[0];
		c_list = inv[1];
	}

	train_pairs = [];
	dev_pairs = [];
	test_pairs = [];

	train_dict = {};
	dev_dict = {};
	test_dict = {};


	for (iqj = 0; iqj < n_dev; iqj++) {
		satisfied = false;
		while (!satisfied) {
			abstract = choice(io_list);

			if ((replace_one_train || replace_all_train) && abstract[0] == "") {
				continue;
			}
			candidate = output_string(abstract[0],abstract[1], v_list, c_list, steps=abstract[2], change_one=replace_one_train, change_all=replace_all_train);
			candidate_str = candidate[0] + candidate[1];


			if (!(candidate_str in dev_dict) && !(candidate_str in test_dict) && abstract_input_filter_train(abstract[0]) && abstract_output_filter_train(abstract[1].replace(/\./g, "")) && input_filter_train(candidate[0]) && output_filter_train(candidate[1].replace(/\./g, ""))) {
				satisfied = true;
				if (periods) {
					train_pairs.push(candidate);
				} else {
					train_pairs.push([candidate[0], candidate[1].replace(/\./g, "")]);
				}

				train_dict[candidate] = 1;

			}

			
		}


		satisfied = false;
		while (!satisfied) {
			abstract = choice(io_list);

			if ((replace_one_dev || replace_all_dev) && abstract[0] == "") {
				continue;
			}


			candidate = output_string(abstract[0],abstract[1], v_list, c_list, steps=abstract[2], change_one=replace_one_dev, change_all=replace_all_dev);

			if (!(candidate in train_dict) && !(candidate in test_dict) && abstract_input_filter_dev(abstract[0]) && abstract_output_filter_dev(abstract[1].replace(/\./g, "")) && input_filter_dev(candidate[0]) && output_filter_dev(candidate[1].replace(/\./g, ""))) {
				satisfied = true;

				if (periods) {
					dev_pairs.push(candidate);
				} else {
					dev_pairs.push([candidate[0], candidate[1].replace(/\./g, "")]);
				}

				dev_dict[candidate] = 1

			}

		}


		satisfied = false;
		while (!satisfied) {
			abstract = choice(io_list);

			if ((replace_one_test || replace_all_test) && abstract[0] == "") {	
				continue;
			}
			
			candidate = output_string(abstract[0],abstract[1], v_list, c_list, steps=abstract[2], change_one=replace_one_test, change_all=replace_all_test);

			console.log(abstract[0]);
			console.log(abstract_input_filter_test(abstract[0]));
			if (!(candidate in train_dict) && !(candidate in dev_dict) && abstract_input_filter_test(abstract[0]) && abstract_output_filter_test(abstract[1].replace(/\./g, "")) && input_filter_test(candidate[0]) || output_filter_test(candidate[1].replace(/\./g, ""))) {
				satisfied = true; 

				if (periods) {
					test_pairs.push(candidate);
				} else {
					test__pairs.push([candidate[0], candidate[1].replace(/\./g, "")]);
				}

				test_dict[candidate] = 1;
			}

		}

	}



	for (iqk = 0; iqk < n_test - n_dev; iqk++) {
		satisfied = false;
		while (!satisfied) {
			abstract = choice(io_list);

			if ((replace_one_train || replace_all_train) && abstract[0] == "") {
				continue;
			}

			candidate = output_string(abstract[0],abstract[1], v_list, c_list, steps=abstract[2], change_one=replace_one_train, change_all=replace_all_train);

			if (!(candidate in dev_dict) && !(candidate in test_dict) && abstract_input_filter_train(abstract[0]) && abstract_output_filter_train(abstract[1].replace(/\./g, "")) && input_filter_train(candidate[0]) && output_filter_train(candidate[1].replace(/\./g, ""))) {
				satisfied = true;
				if (periods) {
					train_pairs.push(candidate);
				} else {
					train_pairs.push([candidate[0], candidate[1].replace(/\./g, "")]);
				}

				train_dict[candidate] = 1;

			}

			
		}

		satisfied = false;
		while (!satisfied) {
			abstract = choice(io_list);

			if ((replace_one_test || replace_all_test) && abstract[0] == "") {	
				continue;
			}
			
			candidate = output_string(abstract[0],abstract[1], v_list, c_list, steps=abstract[2], change_one=replace_one_test, change_all=replace_all_test);

			if (!(candidate in train_dict) && !(candidate in dev_dict) && abstract_input_filter_test(abstract[0]) && abstract_output_filter_test(abstract[1].replace(/\./g, "")) && input_filter_test(candidate[0]) && output_filter_test(candidate[1].replace(/\./g, ""))) {
				satisfied = true; 

				if (periods) {
					test_pairs.push(candidate);
				} else {
					test__pairs.push([candidate[0], candidate[1].replace(/\./g, "")]);
				}

				test_dict[candidate] = 1;
			}

		}

	}


	for (iql = 0; iql < n_train - n_test; iql++) {
		satisfied = false;
		while (!satisfied) {
			abstract = choice(io_list);

			if ((replace_one_train || replace_all_train) && abstract[0] == "") {
				continue;
			}

			candidate = output_string(abstract[0],abstract[1], v_list, c_list, steps=abstract[2], change_one=replace_one_train, change_all=replace_all_train);

			if (!(candidate in dev_dict) && !(candidate in test_dict) && abstract_input_filter_train(abstract[0]) && abstract_output_filter_train(abstract[1].replace(/\./g, "")) && input_filter_train(candidate[0]) && output_filter_train(candidate[1].replace(/\./g, ""))) {
				satisfied = true;
				if (periods) {
					train_pairs.push(candidate);
				} else {
					train_pairs.push([candidate[0], candidate[1].replace(/\./g, "")]);
				}

				train_dict[candidate] = 1;

			}

			
		}


	}


	return [train_pairs, dev_pairs, test_pairs, v_list, c_list, ranking];
	

}


//0 = onset
//1 = nocoda
//2 = max
//3 = dep

const key2description = {
	"(0, 1, 2, 3)" : "Insert <em>CONS</em> or <em>VOW</em>  as necessary to ensure that all syllables are of the form consonant-vowel; add periods to mark syllable boundaries.",
	"(0, 1, 3, 2)" : "Delete sounds as necessary to ensure that all syllables are of the form consonant-vowel; add periods to mark syllable boundaries.",
	"(0, 3, 2, 1)" : "Delete sounds as necessary to ensure that all syllables start with a consonant; add periods to mark syllable boundaries.",
	"(1, 3, 2, 0)" : "Delete sounds as necessary to ensure that all syllables end with a vowel; add periods to mark syllable boundaries.",
	"(0, 2, 3, 1)" : "Insert <em>CONS</em> and <em>VOW</em> as necessary to have all syllables start with a consonant and to make the output pronounceable; add periods to mark syllable boundaries.",
	"(1, 2, 3, 0)" : "Insert <em>VOW</em> as necessary to ensure that all syllables end with a vowel; add periods to mark syllable boundaries.",
	"(3, 2, 0, 1)" : "Delete sounds as necessary to ensure that the output is pronounceable, but otherwise change nothing; add periods to mark syllable boundaries.",
	"(2, 3, 0, 1)" : "Insert <em>VOW</em> as necessary to ensure that the output is pronounceable, but otherwise change nothing; add periods to mark syllable boundaries."
}



rankings = ["(2, 3, 0, 1)", "(3, 2, 0, 1)", "(1, 2, 3, 0)", "(0, 2, 3, 1)", "(1, 3, 2, 0)", "(0, 3, 2, 1)", "(0, 1, 3, 2)", "(0, 1, 2, 3)"]

new_lang = make_task(choice(rankings), all_input_outputs, trf, n_train=100, n_dev=2, n_test=6);

training_set = new_lang[0];
dev_set = new_lang[1];
test_set = new_lang[2];
new_vinv = new_lang[3];
new_cinv = new_lang[4];

test_set_firsts = [];
for (tsf = 0; tsf<test_set.length; tsf++) {
    test_set_firsts.push(test_set[tsf][0]);
}

manual_ranking = new_lang[5];
manual_vowel_inventory = new_vinv;
manual_consonant_inventory = new_cinv;
manual_ep_vow = new_vinv[0];
manual_ep_cons = new_cinv[0];





this_input = word2embs(["zaza"]);
this_input2 = word2embs([".za.za"], sos=true);



var tf_emb_wg = tf.tensor2d(emb_wg, [34,10]);
var weights_emb_bias = tf.zeros([10]);
var tf_full_x = tf.variable(tf.tensor2d(full_x, [10,768]),trainable=true);
var tf_full_w = tf.variable(tf.tensor2d(full_w, [256,768]),trainable=true);
var tf_full_b = tf.variable(tf.tensor(full_b, [3,256]),trainable=true);
var tf_out_wg = tf.variable(tf.tensor(out_wg, [256,34]),trainable=true);
var tf_out_wb = tf.variable(tf.tensor(out_wb, [34]),trainable=true);
var tf_full_xd = tf.variable(tf.tensor2d(full_xd, [10,768]),trainable=true);
var tf_full_wd = tf.variable(tf.tensor2d(full_wd, [256,768]),trainable=true);
var tf_full_bd = tf.variable(tf.tensor(full_bd, [3,256]),trainable=true);



var xz = tf.variable(tf.slice(tf_full_x, [0,0], [10,256]));
var xr = tf.variable(tf.slice(tf_full_x, [0,256], [10,256]));
var xx = tf.variable(tf.slice(tf_full_x, [0,512], [10,256]));
var wz = tf.variable(tf.slice(tf_full_w, [0,0], [256,256]));
var wr = tf.variable(tf.slice(tf_full_w, [0,256], [256,256]));
var wx = tf.variable(tf.slice(tf_full_w, [0,512], [256,256]));
var bz = tf.variable(tf.slice(tf_full_b, [0,0], [1,256]));
var br = tf.variable(tf.slice(tf_full_b, [1,0], [1,256]));
var bx = tf.variable(tf.slice(tf_full_b, [2,0], [1,256]));

var xzd = tf.variable(tf.slice(tf_full_xd, [0,0], [10,256]));
var xrd = tf.variable(tf.slice(tf_full_xd, [0,256], [10,256]));
var xxd = tf.variable(tf.slice(tf_full_xd, [0,512], [10,256]));
var wzd = tf.variable(tf.slice(tf_full_wd, [0,0], [256,256]));
var wrd = tf.variable(tf.slice(tf_full_wd, [0,256], [256,256]));
var wxd = tf.variable(tf.slice(tf_full_wd, [0,512], [256,256]));
var bzd = tf.variable(tf.slice(tf_full_bd, [0,0], [1,256]));
var brd = tf.variable(tf.slice(tf_full_bd, [1,0], [1,256]));
var bxd = tf.variable(tf.slice(tf_full_bd, [2,0], [1,256]));

var emb = tf.variable(tf_emb_wg);

var wout = tf.variable(tf_out_wg);
var bout = tf.variable(tf_out_wb);







var xzb = tf.variable(tf.randomNormal([10,256]));
var xrb = tf.variable(tf.randomNormal([10,256]));
var xxb = tf.variable(tf.randomNormal([10,256]));
var wzb = tf.variable(tf.randomNormal([256,256]));
var wrb = tf.variable(tf.randomNormal([256,256]));
var wxb = tf.variable(tf.randomNormal([256,256]));
var bzb = tf.variable(tf.randomNormal([1,256]));
var brb = tf.variable(tf.randomNormal([1,256]));
var bxb = tf.variable(tf.randomNormal([1,256]));

var xzdb = tf.variable(tf.randomNormal([10,256]));
var xrdb = tf.variable(tf.randomNormal([10,256]));
var xxdb = tf.variable(tf.randomNormal([10,256]));
var wzdb = tf.variable(tf.randomNormal([256,256]));
var wrdb = tf.variable(tf.randomNormal([256,256]));
var wxdb = tf.variable(tf.randomNormal([256,256]));
var bzdb = tf.variable(tf.randomNormal([1,256]));
var brdb = tf.variable(tf.randomNormal([1,256]));
var bxdb = tf.variable(tf.randomNormal([1,256]));

var embb = tf.variable(tf.randomNormal([34,10]));

var woutb = tf.variable(tf.randomNormal([256,34]));
var boutb = tf.variable(tf.randomNormal([34]));










function reset_weights() {


	xz = tf.variable(tf.slice(tf_full_x, [0,0], [10,256]));
	xr = tf.variable(tf.slice(tf_full_x, [0,256], [10,256]));
	xx = tf.variable(tf.slice(tf_full_x, [0,512], [10,256]));
	wz = tf.variable(tf.slice(tf_full_w, [0,0], [256,256]));
	wr = tf.variable(tf.slice(tf_full_w, [0,256], [256,256]));
	wx = tf.variable(tf.slice(tf_full_w, [0,512], [256,256]));
	bz = tf.variable(tf.slice(tf_full_b, [0,0], [1,256]));
	br = tf.variable(tf.slice(tf_full_b, [1,0], [1,256]));
	bx = tf.variable(tf.slice(tf_full_b, [2,0], [1,256]));

	xzd = tf.variable(tf.slice(tf_full_xd, [0,0], [10,256]));
	xrd = tf.variable(tf.slice(tf_full_xd, [0,256], [10,256]));
	xxd = tf.variable(tf.slice(tf_full_xd, [0,512], [10,256]));
	wzd = tf.variable(tf.slice(tf_full_wd, [0,0], [256,256]));
	wrd = tf.variable(tf.slice(tf_full_wd, [0,256], [256,256]));
	wxd = tf.variable(tf.slice(tf_full_wd, [0,512], [256,256]));
	bzd = tf.variable(tf.slice(tf_full_bd, [0,0], [1,256]));
	brd = tf.variable(tf.slice(tf_full_bd, [1,0], [1,256]));
	bxd = tf.variable(tf.slice(tf_full_bd, [2,0], [1,256]));

	emb = tf.variable(tf_emb_wg);

	wout = tf.variable(tf_out_wg);
	bout = tf.variable(tf_out_wb);







	xzb = tf.variable(tf.randomNormal([10,256]));
	xrb = tf.variable(tf.randomNormal([10,256]));
	xxb = tf.variable(tf.randomNormal([10,256]));
	wzb = tf.variable(tf.randomNormal([256,256]));
	wrb = tf.variable(tf.randomNormal([256,256]));
	wxb = tf.variable(tf.randomNormal([256,256]));
	bzb = tf.variable(tf.randomNormal([1,256]));
	brb = tf.variable(tf.randomNormal([1,256]));
	bxb = tf.variable(tf.randomNormal([1,256]));

	xzdb = tf.variable(tf.randomNormal([10,256]));
	xrdb = tf.variable(tf.randomNormal([10,256]));
	xxdb = tf.variable(tf.randomNormal([10,256]));
	wzdb = tf.variable(tf.randomNormal([256,256]));
	wrdb = tf.variable(tf.randomNormal([256,256]));
	wxdb = tf.variable(tf.randomNormal([256,256]));
	bzdb = tf.variable(tf.randomNormal([1,256]));
	brdb = tf.variable(tf.randomNormal([1,256]));
	bxdb = tf.variable(tf.randomNormal([1,256]));

	embb = tf.variable(tf.randomNormal([34,10]));

	woutb = tf.variable(tf.randomNormal([256,34]));
	boutb = tf.variable(tf.randomNormal([34]));

}





var these_zeros = [];
var these_ones = [];
for (xkcd = 0; xkcd < 256; xkcd++) {
	these_zeros.push(0);
	these_ones.push(1);
}





var seen_training = "";

function make_one_hot(index) {
    onehot_vec = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
    onehot_vec[index] = 1;
    return onehot_vec;  
}
function make_one_hot_seq(word, eos=true) {
    length_word = word.length;
    onehot_vec = []

    for (ind = 0; ind < length_word; ind++) {
        charnum = char2ind[word[ind]];
        onehot_vec = onehot_vec.concat(make_one_hot(charnum));
    }

    if (eos) {
        charnum = char2ind["EOS"];
        onehot_vec = onehot_vec.concat(make_one_hot(charnum));
        length_word += 1;
    }

    if (eos && length_word == 1) {
        charnum = char2ind["EOS"];
        onehot_vec = onehot_vec.concat(make_one_hot(charnum));
        length_word += 1;
    }


    return tf.tensor3d(onehot_vec, [1,length_word,34]);
} 

function output_to_string(outp_logits) {
    topks = tf.topk(outp_logits)["indices"];
    topks_usable = topks.dataSync();
    
    out_string = "";
    for (i = 0; i < topks_usable.length; i++) {
        out_string = out_string + ind2char[topks_usable[i]];
    }

    return out_string;
}

function generate_output(model, inp, secondguy) {
    done = false;

    inp1 = word2embs([inp]);
    inp2 = word2embs([""], sos=true);
    //inp2 = word2embs([secondguy.substring(0, training_set[ijk][1].length)], sos=true)

    counter = 0;
    while (!done) {
        counter += 1;
        out_string = output_to_string(model.predict([inp1, inp2]));
        if (out_string[out_string.length - 1] == "Z") {
            done = true;
        } else if (counter > 15) {
            done = true;
        } else {
            inp2 = word2embs([out_string], sos=true);
        }
        
    }

    return out_string.substring(0, out_string.length - 1);
    
}

function word2embs(words, sos=false) {
    n_words = words.length;

    embs_list = [];

    word_length = words[0].length;
    if (sos) {
        word_length += 1;
    }

    for (zx = 0; zx < n_words; zx++) {
        word = words[zx];
        if (word.length != word_length) {
            14/0;
        }
        if (sos) {
            embs_list = embs_list.concat(embedding_dictionary["SOS"]);
        }

        for(i = 0; i < word.length; i++) {
            embs_list = embs_list.concat(embedding_dictionary[word[i]]);
        }
    }
    return tf.tensor3d(embs_list, [n_words,word_length,10]);

}








function embed_seqs(seqs) {
	max_seq_length = 0;
	emb_list = []
	multiplier_list = [];

	for (seqi = 0; seqi < seqs.length; seqi++) {
		this_length = seqs[seqi].length;
		if (this_length > max_seq_length) {
			max_seq_length = this_length;
		}

	}

	for (seqind = 0; seqind < max_seq_length; seqind++) {
		current_emb_list = [];
		current_mult_list = [];

		for (seqk = 0; seqk < seqs.length; seqk++) {
		
			if (seqind < seqs[seqk].length) {
				thischar = seqs[seqk][seqind];
				current_mult_list.push(these_ones.slice());
			} else {
				thischar = "N";
				current_mult_list.push(these_zeros.slice());
			}

			current_emb = embedding_dictionary[thischar];
			current_emb_list = current_emb_list.concat(current_emb);
		}
		emb_list.push(tf.tensor2d(current_emb_list, [seqs.length, 10]));
		multiplier_list.push(tf.tensor2d(current_mult_list, [seqs.length, 256]));
	}

	return [emb_list, multiplier_list];

}

function lst_append(lst, nw) {
	new_lst = [];

	for (lst_ind = 0; lst_ind < lst.length; lst_ind++) {
		new_lst.push(lst[lst_ind] + nw[lst_ind]);
	}

	return new_lst;
}


function seq2seq(inpseqs, outlength=-1) {
	num_seqs = inpseqs.length;

	embs_pair = embed_seqs(inpseqs);
	embs = embs_pair[0];
	mults = embs_pair[1];


	hidden_state = tf.zeros([num_seqs,256]);
	for (qz = 0; qz < embs.length; qz++) {
		inp = embs[qz]; //tf.tensor2d(embedding_dictionary[inpseq[qz]], [1,10]);
		zt = inp.matMul(xz).add(bz).add(hidden_state.matMul(wz)).sigmoid();
		rt = inp.matMul(xr).add(br).add(hidden_state.matMul(wr)).sigmoid();
		urht = rt.mul(hidden_state).matMul(wx).add(bx);
		xt = inp.matMul(xx);
		h_tilde = urht.add(xt).tanh();
		ones = tf.ones([1,256]);
		hidden_state_new = zt.mul(hidden_state).add(ones.sub(zt).mul(h_tilde));

		if (num_seqs > 1) {
			hidden_state = hidden_state_new.mul(mults[qz]).add(hidden_state.mul(ones.sub(mults[qz])));
		} else {
			hidden_state = hidden_state_new;
		}

	}
	prev_output = []; 

	outseq = [];
	for (ns = 0; ns < num_seqs; ns++) {
		prev_output.push("S");
		outseq.push("");
	}
	logits = [];

	if (outlength == -1) {
		max_length = 15;
	} else if (outlength == 0) {
		max_length = 1;
	} else {
		max_length = outlength;
	}
	for (qz = 0; qz < max_length + 1; qz++) {
		inp = embed_seqs(prev_output)[0][0]; //tf.tensor2d(embedding_dictionary[prev_output], [1,10]);
		zt = inp.matMul(xzd).add(bzd).add(hidden_state.matMul(wzd)).sigmoid();
		rt = inp.matMul(xrd).add(brd).add(hidden_state.matMul(wrd)).sigmoid();
		urht = rt.mul(hidden_state).matMul(wxd).add(bxd);
		xt = inp.matMul(xxd);
		h_tilde = urht.add(xt).tanh();
		ones = tf.ones([1,256]);
		hidden_state = zt.mul(hidden_state).add(ones.sub(zt).mul(h_tilde));

		logit = hidden_state.matMul(wout).add(bout);//HEREHERE
		logits = logits.concat(logit);

		topks = tf.topk(logit)["indices"];
    	topks_usable = topks.dataSync();


		prev_output = []; 
		for (zzz = 0; zzz < topks_usable.length; zzz++) {
			prev_output.push(ind2char[topks_usable[zzz]]);
		}

		if (outlength == -1 && prev_output == "Z") {
			break;
		}
		
		outseq = lst_append(outseq, prev_output);
	}


	return [outseq, tf.stack(logits, axis=1)];	

}


function seq2seqb(inpseqs, outlength=-1) {
	num_seqs = inpseqs.length;
	embs_pair = embed_seqs(inpseqs);
    embs = embs_pair[0];
    mults = embs_pair[1];

	outseq = "";
	hidden_state = tf.zeros([num_seqs,256]);
	for (qz = 0; qz < embs.length; qz++) {
		inp = embs[qz]; //tf.tensor2d(embedding_dictionary[inpseq[qz]], [1,10]);
		zt = inp.matMul(xzb).add(bzb).add(hidden_state.matMul(wzb)).sigmoid();
		rt = inp.matMul(xrb).add(brb).add(hidden_state.matMul(wrb)).sigmoid();
		urht = rt.mul(hidden_state).matMul(wxb).add(bxb);
		xt = inp.matMul(xxb);
		h_tilde = urht.add(xt).tanh();
		ones = tf.ones([1,256]);
		hidden_state_new = zt.mul(hidden_state).add(ones.sub(zt).mul(h_tilde));

		if (num_seqs > 1) {
			hidden_state = hidden_state_new.mul(mults[qz]).add(hidden_state.mul(ones.sub(mults[qz])));
		} else {
			hidden_state = hidden_state_new;
		}

	}

	prev_output = [];
	outseq = [];

	for (ns = 0; ns < num_seqs; ns++) {
		prev_output.push("S");
		outseq.push("");
	}


	logits = [];

	if (outlength == -1) {
		max_length = 15;
	} else if (outlength == 0) {
		max_length = 1;
	} else {
		max_length = outlength;
	}
	for (qz = 0; qz < max_length + 1; qz++) {
		inp = embed_seqs(prev_output)[0][0]; //tf.tensor2d(embedding_dictionary[prev_output], [1,10]);

		zt = inp.matMul(xzdb).add(bzdb).add(hidden_state.matMul(wzdb)).sigmoid();
		rt = inp.matMul(xrdb).add(brdb).add(hidden_state.matMul(wrdb)).sigmoid();
		urht = rt.mul(hidden_state).matMul(wxdb).add(bxdb);
		xt = inp.matMul(xxdb);
		h_tilde = urht.add(xt).tanh();
		ones = tf.ones([1,256]);
		hidden_state = zt.mul(hidden_state).add(ones.sub(zt).mul(h_tilde));

		logit = hidden_state.matMul(woutb).add(boutb);//HEREHERE
		logits = logits.concat(logit);

		topks = tf.topk(logit)["indices"];
    	topks_usable = topks.dataSync();

		prev_output = [];
		for (zzz = 0; zzz < topks_usable.length; zzz++) {
			prev_output.push(ind2char[topks_usable[zzz]]);
		}

		if (outlength == -1 && prev_output == "Z") {
			break;
		}

		outseq = lst_append(outseq, prev_output);
	}


	return [outseq, tf.stack(logits, axis=1)];	

}







var xsm = training_set[0][0];
var ysm = training_set[0][1];



function* data() {
 for (let i = 0; i < 1; i++) {
   // Generate one sample at a time.
   yield "attt";
 }
}

function* labels() {
 for (let i = 0; i < 1; i++) {
   // Generate one sample at a time.
   yield ".a.";
 }
}



//const xsa = tf.data.generator(data);
//const ysa = tf.data.generator(labels);
// Zip the data and labels together, shuffle and batch 32 samples at a time.
//const dsa = tf.data.zip({xsa, ysa}).shuffle(100 /* bufferSize */).batch(32);

const xsma = tf.data.generator(data);
const ysma = tf.data.generator(labels);
const ds = tf.data.zip({xsma, ysma}).shuffle(100).batch(1);

function return_inps() {
	return xs, ys;
}



async function fitfitfitfirst(seq2seq, prefix, add_train=false) {


const optimizer = tf.train.sgd(0.05);
// Train for 5 epochs.
for (let epoch = 0; epoch < 1; epoch++) {
  await ds.forEachAsync(({xs, ys}) => {
    optimizer.minimize(() => {
	  if (add_train) {
	  	xsm = training_set[this_counter][0];
		ysm = training_set[this_counter][1];
		seen_training = seen_training + nullify(xsm) + " &rarr; " + nullify(ysm) + "<br>";
	  	this_counter += 1;
		if (this_counter > training_set.length - 1) {
			document.getElementById("oneexamplebtn").disabled = true;
		}
		document.getElementById("traincount").innerHTML = this_counter - 1;
		document.getElementById("traincount2").innerHTML = this_counter - 1;
		if (this_counter - 1 == 1) {
			document.getElementById("exsing").innerHTML = "example";
		} else {
			document.getElementById("exsing").innerHTML = "examples";
		}


	  }
      const predYs = tf.tidy(() => seq2seq([xsm],outlength=ysm.length)[1]);
	  
      const loss = tf.losses.softmaxCrossEntropy(make_one_hot_seq(ysm), predYs, axis=1);
      loss.data().then(l => console.log('Loss', l));

      return loss;
    });
  });

}


}

function update_display(seq2seq, prefix) {

  preds = tf.tidy(() => seq2seq(test_set_firsts)[0]);
  for (lmnop = 0; lmnop < test_set.length; lmnop++) {
	pred = toz(preds[lmnop]);
 	if (pred == test_set[lmnop][1]) {
    	font_color = "green";
    } else {
    	font_color = "red";
    }
			
	document.getElementById(prefix + "outb" + (lmnop + 1)).innerHTML = "<span style='color: " + font_color + ";'>" + nullify(pred) + "</span>";
  }

	  	document.getElementById("trainingexamplelist").innerHTML = seen_training;
		document.getElementById("trainingexamplelist").scrollTop = document.getElementById("trainingexamplelist").scrollHeight;


		document.getElementById("traincount").innerHTML = this_counter;
		document.getElementById("traincount2").innerHTML = this_counter;

		if (this_counter == 1) {
			document.getElementById("exsing").innerHTML = "example";
		} else {
			document.getElementById("exsing").innerHTML = "examples";
		}




}
async function fitfitfit(seq2seq, prefix, add_train=false) {
setTimeout(async function () {
	//update_display(seq2seq, prefix);
const optimizer = tf.train.sgd(0.05);
// Train for 5 epochs.
for (let epoch = 0; epoch < 1; epoch++) {


  await ds.forEachAsync(({xs, ys}) => {

  preds = tf.tidy(() => seq2seq(test_set_firsts)[0]);
  seen_training_prime = seen_training;
    optimizer.minimize(() => {
	  if (add_train) {
	  	xsm = training_set[this_counter][0];
		ysm = training_set[this_counter][1];
		seen_training = seen_training + nullify(xsm) + " &rarr; " + nullify(ysm) + "<br>";
	  	this_counter += 1;
		if (this_counter > training_set.length - 1) {
			document.getElementById("oneexamplebtn").disabled = true;
		}
	  }
      const predYs = tf.tidy(() => seq2seq([xsm],outlength=ysm.length)[1]);
	  
      const loss = tf.losses.softmaxCrossEntropy(make_one_hot_seq(ysm), predYs, axis=1);
      loss.data().then(l => console.log('Loss', l));


      return loss;
    });


  for (lmnop = 0; lmnop < test_set.length; lmnop++) {
	pred = toz(preds[lmnop]);
 	if (pred == test_set[lmnop][1]) {
    	font_color = "green";
    } else {
    	font_color = "red";
    }
			
	document.getElementById(prefix + "outb" + (lmnop + 1)).innerHTML = "<span style='color: " + font_color + ";'>" + nullify(pred) + "</span>";
  }

	if (add_train) {
	  	document.getElementById("trainingexamplelist").innerHTML = seen_training_prime;
		document.getElementById("trainingexamplelist").scrollTop = document.getElementById("trainingexamplelist").scrollHeight;


		document.getElementById("traincount").innerHTML = this_counter - 1;
		document.getElementById("traincount2").innerHTML = this_counter - 1;
		if (this_counter - 1 == 1) {
			document.getElementById("exsing").innerHTML = "example";
		} else {
			document.getElementById("exsing").innerHTML = "examples";
		}


	}


  });

}

}, 1);


}




	  preds = tf.tidy(() => seq2seq(test_set_firsts)[0]);
	  for (lmnop = 0; lmnop < test_set.length; lmnop++) {
			pred = toz(preds[lmnop])
			if (pred == test_set[lmnop][1]) {
				font_color = "green";
			} else {
				font_color = "red";
			}
			document.getElementById("metaoutb" + (lmnop + 1)).innerHTML = "<span style='color: " + font_color + ";'>" + nullify(pred) + "</span>";
	  }


	  preds = tf.tidy(() => seq2seqb(test_set_firsts)[0]);
	  for (lmnop = 0; lmnop < test_set.length; lmnop++) {
			pred = toz(preds[lmnop]);
			if (pred == test_set[lmnop][1]) {
                font_color = "green";
            } else {
                font_color = "red";
            }


			document.getElementById("randomoutb" + (lmnop + 1)).innerHTML = "<span style='color: " + font_color + ";'>" + nullify(pred) + "</span>";
	  }


renew_language();

document.getElementById("rankbtn").innerHTML = key2ranking[manual_ranking];
document.getElementById("langdesc").innerHTML = key2description[new_lang[5]].replace("CONS", new_lang[4][0]).replace("VOW", new_lang[3][0]);


/* When the user clicks on the button,
toggle between hiding and showing the dropdown content */
function dropFunction() {
  document.getElementById("myDropdown").classList.toggle("show");
}

function dropFunction2() {
  document.getElementById("myDropdown2").classList.toggle("show");
}


// Close the dropdown menu if the user clicks outside of it
window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {
    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}

size = 200;
mmult = size/10;
halfsize = size/2;

function drawStar(centerX, centerY, points, outer, inner, fill, stroke, line) {
    // define the star
    ctx.beginPath();
    ctx.moveTo(centerX, centerY+outer);
    for (var i=0; i < 2*points+1; i++) {
        var r = (i%2 == 0)? outer : inner;
        var a = Math.PI * i/points;
        ctx.lineTo(centerX + r*Math.sin(a), centerY + r*Math.cos(a));
    };
    ctx.closePath();
    // draw
    ctx.fillStyle=fill;
    ctx.fill();
    ctx.strokeStyle=stroke;
    ctx.lineWidth=line;
    ctx.stroke()
}


var slope = 3;
var intercept = 2;
var rinner = 0.5;
var router = 0.01;



var canvas2 = document.getElementById("myCanvas2");
var ctx2 = canvas2.getContext("2d");


ctx2.beginPath();
ctx2.moveTo(0, halfsize);
ctx2.lineTo(2*halfsize, halfsize);
ctx2.stroke();

ctx2.moveTo(halfsize, 0);
ctx2.lineTo(halfsize, 2*halfsize);
ctx2.stroke();


ctx2.beginPath();
ctx2.lineWidth = 3;
ctx2.setLineDash([]);
ctx2.moveTo(-1*halfsize, -mmult*(slope*-10 + intercept) + halfsize);
ctx2.lineTo(3*halfsize, -mmult*(slope*10 + intercept) + halfsize);
ctx2.strokeStyle="mediumseagreen";
ctx2.stroke();


var canvas = document.getElementById("myCanvas");
var ctx = canvas.getContext("2d");


ctx.moveTo(0, halfsize);
ctx.lineTo(2*halfsize, halfsize);
ctx.stroke();

ctx.moveTo(halfsize, 0);
ctx.lineTo(halfsize, 2*halfsize);
ctx.stroke();
ctx.beginPath();
ctx.arc(2*mmult, 7*mmult, mmult, 0, 2 * Math.PI);
ctx.stroke();

ctx.font = "12px Arial";
ctx.fillStyle="black";
ctx.fillText("Intercept", halfsize-30, 20); 
ctx.fillText("Slope", 10, halfsize-5); 

ctx2.font = "12px Arial";
ctx2.fillStyle="black";
ctx2.fillText("Output", halfsize-30, 20);   
ctx2.fillText("Input", 10, halfsize-5); 

drawStar(mmult*3+halfsize, -mmult*2+halfsize, 5, 3, 6, 'mediumseagreen','gray',1);

function loss(m,b,x1,x2,y1,y2,r) {
	l1 = m * x2 + 2*r*x1*y1*x2 - 2*r*(x1*x1)*m*x2 - 2*r*b*x1*x2 + b + 2*r*y1 - 2*r*m*x1 - 2*r*b - y2;
	
	dldm = 2*l1 * (x2 - 2*r*(x1*x1)*x2 - 2*r*x1);
	dldb = 2*l1*(-2*r*x1*x2 + 1 - 2*r);

	return [dldm, dldb];

}


function loss_non_meta(m,b,x,y) {
	dldm = -2*x*y + 2*x*x*m + 2*b*x;
	dldb = -2*y + 2*m*x + 2*b;

	return [dldm, dldb];
}

demo_ind = 0;

var looping = false;

function resetDemo() {
	document.getElementById("mamltext").innerHTML = "<br>";

	endMyLoop();

	if (looping) {
		timeoutTime = 3000;
	} else {
		timeoutTime = 1;
	}

	setTimeout(function () {

		ctx.clearRect(0,0,canvas.width,canvas.height);
		ctx2.clearRect(0,0,canvas.width,canvas.height);

		ctx.beginPath();
		ctx2.beginPath();
		ctx2.setLineDash([]);

		slope = 3;
		intercept = 2;
		rinner = 0.5;
		router = 0.01;

		ctx2.lineWidth=1;
		ctx2.strokeStyle="gray";
		ctx2.beginPath();
		ctx2.moveTo(0, halfsize);
		ctx2.lineTo(2*halfsize, halfsize);
		ctx2.stroke();

		ctx2.moveTo(halfsize, 0);
		ctx2.lineTo(halfsize, 2*halfsize);
		ctx2.stroke();


		ctx2.lineWidth = 3;
		ctx2.beginPath();
		ctx2.setLineDash([]);
		ctx2.moveTo(-1*halfsize, -mmult*(slope*-10 + intercept) + halfsize);
		ctx2.lineTo(3*halfsize, -mmult*(slope*10 + intercept) + halfsize);
		ctx2.strokeStyle="mediumseagreen";
		ctx2.stroke();


		ctx.moveTo(0, halfsize);
		ctx.lineTo(2*halfsize, halfsize);
		ctx.stroke();

		ctx.moveTo(halfsize, 0);
		ctx.lineTo(halfsize, 2*halfsize);
		ctx.stroke();
		ctx.beginPath();
		ctx.arc(2*mmult, 7*mmult, mmult, 0, 2 * Math.PI);
		ctx.stroke();

		ctx.font = "12px Arial";
		ctx.fillStyle="black";
		ctx.fillText("Intercept", halfsize-30, 20); 
		ctx.fillText("Slope", 10, halfsize-5); 

		ctx2.font = "12px Arial";
		ctx2.fillStyle="black";
		ctx2.fillText("Output", halfsize-30, 20);   
		ctx2.fillText("Input", 10, halfsize-5); 

		drawStar(mmult*3+halfsize, -mmult*2+halfsize, 5, 3, 6, 'mediumseagreen','gray',1);
	}, timeoutTime);

}

function endMyLoop() {
	looping = false;

	document.getElementById("mamlstart").innerHTML = "Start demo";
	document.getElementById("mamlstart").setAttribute('onclick','myLoop()');

}

function myLoop() {

	looping = true;

	document.getElementById("mamlstart").innerHTML = "Pause demo";
	document.getElementById("mamlstart").setAttribute('onclick','endMyLoop()');

	setTimeout(function () {
	if (looping) {
	randnum = 2 * Math.PI * Math.random();
	mcorr = Math.cos(randnum) - 3;
	bcorr = Math.sin(randnum) -2;
	//bcorr = Math.sqrt((1.0 - randnum*randnum)) - 2;
	
	cointoss = choice([0,1]);
	if (cointoss == 0) {
		bcorr = -1 * (bcorr + 4);
	}

	x1 = 2 * Math.random() - 1;
	x2 = 2 * Math.random() - 1;
	x3 = 2 * Math.random() - 1; //

	y1 = mcorr*x1 + bcorr;
	y2 = mcorr*x2 + bcorr;
	y3 = mcorr*x3 + bcorr; //

	losses = loss(slope, intercept, x1, x2, y1, y2, rinner);
	dldm = losses[0];
	dldb = losses[1];

	inner_losses = loss_non_meta(slope,intercept,x1,y1);
	dldmi = inner_losses[0];
	dldbi = inner_losses[1];

	all_points = [];

	for (qinn = 0; qinn < 10; qinn++) {	
		x3 = 2 * Math.random() - 1;
		y3 = mcorr*x3 + bcorr;

		all_points.push([x3, y3]);

		inner_losses_b = loss_non_meta(slope,intercept,x3,y3);
		dldmi = dldmi + inner_losses_b[0];
		dldbi = dldbi + inner_losses_b[1];

		losses_b = loss(slope, intercept, x3, x2, y3, y2, rinner);
		dldm = dldm + losses_b[0];
		dldb = dldb + losses_b[1];
	}

	dldmi = dldmi/11;
	dldbi = dldbi/11;

	slopenew = slope - router*dldm;
	interceptnew = intercept - router*dldb;

	slopenewb = slope - rinner*dldmi;
	interceptnewb = intercept - rinner*dldbi;


	ctx.clearRect(0, 0, canvas.width, canvas.height);
	ctx.font = "12px Arial";
	ctx.fillStyle="black";
	ctx.fillText("Intercept", halfsize-30, 20);	
	ctx.fillText("Slope", 10, halfsize-5); 

	ctx.lineWidth=0;
	ctx.beginPath();
    ctx.rect(mmult*mcorr+halfsize-3, -mmult*bcorr+halfsize-3, 7, 7);
    ctx.fillStyle="purple";
    ctx.fillRect(mmult*mcorr+halfsize-3, -mmult*bcorr+halfsize-3, 7, 7); 	
	//drawStar(30*mcorr+150, -30*bcorr+150, 5, 3, 6, 'purple','gray',0);

	if (pace <= 5) {
		document.getElementById("mamltext").innerHTML = "Step 1: Choose target function";
	} else {
		document.getElementById("mamltext").innerHTML = "<br>";
	}


	ctx2.clearRect(0, 0, canvas2.width, canvas2.height);

	ctx2.font = "12px Arial";
    ctx2.fillStyle="black";
    ctx2.fillText("Output", halfsize-30, 20);   
    ctx2.fillText("Input", 10, halfsize-5); 

	ctx2.beginPath();

	ctx2.lineWidth = 1;
	ctx2.setLineDash([]);
	ctx2.moveTo(0, halfsize);
	ctx2.lineTo(2*halfsize, halfsize);
	ctx2.strokeStyle="gray";
	ctx2.stroke();

	ctx2.beginPath();
	ctx2.lineWidth = 1;
	ctx2.setLineDash([]);
	ctx2.moveTo(halfsize, 0);
	ctx2.lineTo(halfsize, 2*halfsize);
	ctx2.strokeStyle="gray";
	ctx2.stroke();

	for (ap = 0; ap < all_points.length; ap++) {
		this_pt = all_points[ap];
		xcoord = mmult*this_pt[0] + halfsize;
		ycoord = -mmult*this_pt[1] + halfsize;
		ctx2.fillStyle="purple";
		ctx2.fillRect(xcoord, ycoord, 5, 5);
		
	}
	
	ctx.moveTo(0, halfsize);
	ctx.lineTo(2*halfsize, halfsize);
	ctx.stroke();

	ctx.moveTo(halfsize, 0);
	ctx.lineTo(halfsize, 2*halfsize);
	ctx.stroke();

	ctx.beginPath();
	ctx.arc(2*mmult, 7*mmult, mmult, 0, 2 * Math.PI);
	ctx.stroke();
	drawStar(mmult*slope+halfsize, -mmult*intercept+halfsize, 5, 3, 6, 'mediumseagreen','gray',0);

	ctx2.beginPath();
	ctx2.lineWidth = 3;
	ctx2.setLineDash([]);
	ctx2.moveTo(-1*halfsize, -mmult*(slope*-10 + intercept) + halfsize);
	ctx2.lineTo(3*halfsize, -mmult*(slope*10 + intercept) + halfsize);
	ctx2.strokeStyle="mediumseagreen";
	ctx2.stroke();
	
	setTimeout(function () {

		if (looping) {
		ctx.beginPath();
		ctx.arc(mmult*slopenewb+halfsize, -mmult*interceptnewb+halfsize, 4, 0, 2 * Math.PI);
		ctx.fillStyle = "orange";
		ctx.fill();

		if (pace <= 5) {	
			document.getElementById("mamltext").innerHTML = "Step 2: Train a copy of the model";
		} else {
			document.getElementById("mamltext").innerHTML = "<br>";
		}
	
		ctx.strokeStyle='gray';
    	ctx.lineWidth=0;
		ctx.stroke();
	
		ctx.beginPath();
		//drawStar(mmult*slopenewb+halfsize, -mmult*interceptnewb+halfsize, 5, 3, 6, 'orange','gray',0);
		ctx.moveTo(mmult*slope+halfsize, -mmult*intercept+halfsize);
		ctx.lineTo(mmult*slopenewb+halfsize, -mmult*interceptnewb+halfsize);
		ctx.stroke();


		ctx2.beginPath();
		ctx2.lineWidth = 3;
		ctx2.setLineDash([10, 10]);
		ctx2.moveTo(-1*halfsize, -mmult*(slopenewb*-10 + interceptnewb) + halfsize);
		ctx2.lineTo(3*halfsize, -mmult*(slopenewb*10 + interceptnewb) + halfsize);
		ctx2.strokeStyle="orange";
		ctx2.stroke();
	
		setTimeout(function () {

			if (looping) {
			slope = slopenew;
			intercept = interceptnew;

			ctx.clearRect(0, 0, canvas.width, canvas.height);
			ctx2.clearRect(0, 0, canvas2.width, canvas2.height);


			ctx2.font = "12px Arial";
	    	ctx2.fillStyle="black";
		    ctx2.fillText("Output", halfsize-30, 20);   
    		ctx2.fillText("Input", 10, halfsize-5); 

			ctx2.beginPath();

			ctx2.lineWidth = 1;
			ctx2.setLineDash([]);
			ctx2.moveTo(0, halfsize);
			ctx2.lineTo(2*halfsize, halfsize);
			ctx2.strokeStyle="gray";
			ctx2.stroke();

			ctx2.beginPath();
			ctx2.lineWidth = 1;
			ctx2.setLineDash([]);
			ctx2.moveTo(halfsize, 0);
			ctx2.lineTo(halfsize, 2*halfsize);
			ctx2.strokeStyle="gray";
			ctx2.stroke();

			for (ap = 0; ap < all_points.length; ap++) {
				this_pt = all_points[ap];
				xcoord = mmult*this_pt[0] + halfsize;
				ycoord = -mmult*this_pt[1] + halfsize;
				ctx2.fillStyle="purple";
				ctx2.fillRect(xcoord, ycoord, 5, 5);
		
			}
			ctx2.beginPath();
        	ctx2.lineWidth = 3;
	        ctx2.setLineDash([10, 10]);
	        ctx2.moveTo(-1*halfsize, -mmult*(slopenewb*-10 + interceptnewb) + halfsize);
    	    ctx2.lineTo(3*halfsize, -mmult*(slopenewb*10 + interceptnewb) + halfsize);
        	ctx2.strokeStyle="orange";
	        ctx2.stroke();	


			ctx.font = "12px Arial";
			ctx.fillStyle="black";
			ctx.fillText("Intercept", halfsize-30, 20);	
			ctx.fillText("Slope", 10, halfsize-5);

			ctx.beginPath();
			ctx.fillStyle="purple";
        	ctx.fillRect(mmult*mcorr+halfsize-3, -mmult*bcorr+halfsize-3, 7, 7); 
			//drawStar(30*mcorr+150, -30*bcorr+150, 5, 3, 6, 'purple','gray',0);	
	
			ctx.beginPath();
			ctx.strokeStyle="gray";
			ctx.rect(mmult*mcorr+halfsize-3, -mmult*bcorr+halfsize-3, 7, 7);
			ctx.stroke();
					

			ctx.beginPath();
        	ctx.arc(mmult*slopenewb+halfsize, -mmult*interceptnewb+halfsize, 4, 0, 2 * Math.PI);
     	    ctx.fillStyle = "orange";
        	ctx.fill();
        
        	ctx.strokeStyle='gray';
        	ctx.lineWidth=0;
        	ctx.stroke();
    
        	ctx.beginPath();


			//drawStar(30*slopenewb+150, -30*interceptnewb+150, 5, 3, 6, 'orange','gray',0);
			ctx.moveTo(mmult*slope+halfsize, -mmult*intercept+halfsize);
			ctx.lineTo(mmult*slopenewb+halfsize, -mmult*interceptnewb+halfsize);
			ctx.stroke();


			if (pace <= 5) {
				document.getElementById("mamltext").innerHTML = "Step 3: Adjust model initialization";
			} else {
				document.getElementById("mamltext").innerHTML = "<br>";
			}
	
			drawStar(mmult*slope+halfsize, -mmult*intercept+halfsize, 5, 3, 6, 'mediumseagreen','gray',0);
			ctx.moveTo(0, halfsize);
			ctx.lineTo(2*halfsize, halfsize);
			ctx.stroke();

			ctx2.beginPath();
    		ctx2.lineWidth = 3;
    		ctx2.setLineDash([]);
    		ctx2.moveTo(-halfsize, -mmult*(slope*-10 + intercept) + halfsize);
    		ctx2.lineTo(3*halfsize, -mmult*(slope*10 + intercept) + halfsize);
    		ctx2.strokeStyle="mediumseagreen";
    		ctx2.stroke();

			ctx.moveTo(halfsize, 0);
			ctx.lineTo(halfsize, 2*halfsize);
			ctx.stroke();

			ctx.beginPath();
			ctx.arc(2*mmult, 7*mmult, mmult, 0, 2 * Math.PI);
			ctx.stroke();
			demo_ind++;

			if (demo_ind < 10000 && looping) {
				myLoop();
			}
		}}, 3000/(Math.pow(2, pace)))

	}}, 3000/(Math.pow(2, pace)))

	}}, 3000/(Math.pow(2, pace)))
}
var pace = 1;



var slider = document.getElementById("myRange");
//var output = document.getElementById("demo");
slider.value = 1;
//output.innerHTML = slider.value; // Display the default slider value

// Update the current slider value (each time you drag the slider handle)
slider.oninput = function() {
  //output.innerHTML = this.value;
  pace = Math.sqrt(this.value);
}





function get_manual_set(textarea,max,type,min) {
	entered_text = document.getElementById(textarea).value;

	train_list = [];

	trainlines = entered_text.split(/\r?\n/)
	if (trainlines.length == 0) {
		return [false, "Error: Must input at least one example for the " + type + " and test set"];
	}

	if (trainlines.length > max) {
		return [false, "Must input no more than " + max + " examples for the " + type + " set"]
	}

	
	for (i = 0; i < trainlines.length; i++) {
		charlist = trainlines[i].split('');
		contains_comma = charlist.indexOf(",")

		if (contains_comma == -1) {
			return [false,"Error: Each " + type + " set line must contain a comma"];
		}

		in_out_pair = trainlines[i].split(",");
		if (in_out_pair.length > 2) {
			return [false, "Each line must contain exactly one comma"];
		}
		
		for (j = 0; j < charlist.length; j++) {
			thischar = charlist[j];

			if (vowels.indexOf(thischar) == -1 && consonants.indexOf(thischar) == -1 && thischar != "." && thischar != ",") {
				return [false,"Error: You may not use the character '" + thischar + "'"]
			}

		}
		
		

		train_list.push(in_out_pair);
	}

	console.log(charlist)

	return [true,train_list];
	
}

function manual_train_set() {
	inputted_train = get_manual_set("traintextarea",1000,"training",5);
	inputted_test = get_manual_set("testtextarea",6,"test",5);
	
	valid_train = inputted_train[0];
	valid_test = inputted_test[0];
	if (!valid_train) {
		document.getElementById("errorarea").innerHTML = inputted_train[1];
		return [false, false];
	} else if (!valid_test) {
		document.getElementById("errorarea").innerHTML = inputted_test[1];
		return [false, false];
	} else {
		document.getElementById("errorarea").innerHTML = "Input processed successfully";
		inputted_train[1].push(["fake", "fake"]);
		return [true, inputted_train[1], inputted_test[1]];
	}

}


</script>


</body>



</html>


